<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="NewStar CTF 2025 Crypto æ–¹å‘é¢˜ç›®è§£æ">
<title>NewStar CTF 2025 Crypto WP</title>

<link rel='canonical' href='http://localhost:1313/p/newstar-ctf-2025-crypto-wp/'>

<link rel="stylesheet" href="/scss/style.min.4d36f8dc1fd48129e1635deb4b8eb2870fa09474f7280c4cb606d40b2526994b.css"><meta property='og:title' content="NewStar CTF 2025 Crypto WP">
<meta property='og:description' content="NewStar CTF 2025 Crypto æ–¹å‘é¢˜ç›®è§£æ">
<meta property='og:url' content='http://localhost:1313/p/newstar-ctf-2025-crypto-wp/'>
<meta property='og:site_name' content='Hataçš„å°å±‹'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Crypto' /><meta property='article:published_time' content='2025-11-04T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-11-04T00:00:00&#43;00:00'/><meta property='og:image' content='http://localhost:1313/p/newstar-ctf-2025-crypto-wp/fengmian.jpg' />
<meta name="twitter:title" content="NewStar CTF 2025 Crypto WP">
<meta name="twitter:description" content="NewStar CTF 2025 Crypto æ–¹å‘é¢˜ç›®è§£æ"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://localhost:1313/p/newstar-ctf-2025-crypto-wp/fengmian.jpg' />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
        
        <figure class="site-avatar">
            <a href="/">
                
                
                
                
                <img src="/img/avatar_hu_1f41586fb0ce9a39.png" width="300"
                    height="300" class="site-logo" loading="lazy" alt="Avatar">
                
                
            </a>
            
            <span class="emoji">ğŸ¤”</span>
            
        </figure>
        
        

        <div class="site-meta">
            <h1 class="site-name"><a href="/">Hataçš„å°å±‹</a></h1>
            <h2 class="site-description">æ¬²ä¹°æ¡‚èŠ±åŒè½½é…’ï¼Œç»ˆä¸ä¼¼ï¼Œ......</h2>
        </div>
    </header>

    
    <ol class="menu-social">
        
        <li>
            <a href="https://github.com/hataovo" target="_blank" title="GitHub" rel="me">
                
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



            </a>
        </li>
        
    </ol>
    

    <ol class="menu" id="main-menu">
        
        
        
        
            
        
        
            
        
        
            
        
        
            
        
        
        <li>
            <a href="/">
                
                
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                <span>ä¸»é¡µ</span>
            </a>
            </li>
            
            
        
        
        <li>
            <a href="/archives/">
                
                
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                <span>å½’æ¡£</span>
            </a>
            </li>
            
            
        
        
        <li>
            <a href="/tags/">
                
                
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11 3L20 12a1.5 1.5 0 0 1 0 2L14 20a1.5 1.5 0 0 1 -2 0L3 11v-4a4 4 0 0 1 4 -4h4" />
  <circle cx="9" cy="9" r="2" />
</svg>



                <span>æ ‡ç­¾</span>
            </a>
            </li>
            
            
        
        
        <li>
            <a href="/search/">
                
                
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                <span>æœç´¢</span>
            </a>
            </li>
            
            
        
        
        <li>
            <a href="/links/">
                
                
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                <span>é“¾æ¥</span>
            </a>
            </li>
            
            

            <li class="menu-bottom-section">
                <ol class="menu">
                    
                    

                    
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                    
                </ol>
            </li>
    </ol>
</aside>
    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#week-1">Week 1</a>
      <ol>
        <li><a href="#å”¯ä¸€è¡¨ç¤º">å”¯ä¸€è¡¨ç¤º</a></li>
        <li><a href="#å°è·³è›™">å°è·³è›™</a></li>
        <li><a href="#åˆè¯†rsa">åˆè¯†RSA</a></li>
        <li><a href="#éšæœºæ•°ä¹‹æ—…1">éšæœºæ•°ä¹‹æ—…1</a></li>
        <li><a href="#sagemathä½¿ç”¨æŒ‡å“ª">Sagemathä½¿ç”¨æŒ‡å“ªï¼Ÿ</a></li>
      </ol>
    </li>
    <li><a href="#week-2">Week 2</a>
      <ol>
        <li><a href="#ç½®æ¢">ç½®æ¢</a></li>
        <li><a href="#fhe-0-and-1">FHE: 0 and 1</a></li>
        <li><a href="#rsa_revenge">RSA_revenge</a></li>
        <li><a href="#ç¾¤è®ºå°æµ‹è¯•">ç¾¤è®ºå°æµ‹è¯•</a></li>
        <li><a href="#dlp_1">DLP_1</a></li>
      </ol>
    </li>
    <li><a href="#week3">Week3</a>
      <ol>
        <li><a href="#æ¬§çš‡çš„ç”Ÿæ—¥">æ¬§çš‡çš„ç”Ÿæ—¥</a></li>
        <li><a href="#gcl">GCL</a></li>
        <li><a href="#éšæœºæ•°ä¹‹æ—…3">éšæœºæ•°ä¹‹æ—…3</a></li>
        <li><a href="#cbcä¹‹èˆ">CBCä¹‹èˆ</a></li>
        <li><a href="#è¢«æ³„éœ²çš„ç´ æ•°">è¢«æ³„éœ²çš„ç´ æ•°</a></li>
      </ol>
    </li>
    <li><a href="#week4">Week4</a>
      <ol>
        <li><a href="#éšæœºæ•°ä¹‹æ—…4">éšæœºæ•°ä¹‹æ—…4</a></li>
        <li><a href="#ç‹¬ä¸€æ— äºŒ">ç‹¬ä¸€æ— äºŒ</a></li>
        <li><a href="#å…±è½­è¿·å®«">å…±è½­è¿·å®«</a></li>
        <li><a href="#å¤©è™«çš„ç§˜å¯†">å¤©è™«çš„ç§˜å¯†</a></li>
        <li><a href="#ä¸‰é‡å¯†é’¥é”">ä¸‰é‡å¯†é’¥é”</a></li>
      </ol>
    </li>
    <li><a href="#week5">Week5</a>
      <ol>
        <li><a href="#poly">Poly</a></li>
        <li><a href="#smileç›’">Smileç›’</a></li>
        <li><a href="#ä¸ç»™ä½ çœ‹å–µ">ä¸ç»™ä½ çœ‹å–µ</a></li>
        <li><a href="#blså¤šé‡ç­¾åé›¶çš„è£‚å˜">BLSå¤šé‡ç­¾åï¼šé›¶çš„è£‚å˜</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/newstar-ctf-2025-crypto-wp/">
                <img src="/p/newstar-ctf-2025-crypto-wp/fengmian_hu_7e8add7a2004bc1e.jpg"
                        srcset="/p/newstar-ctf-2025-crypto-wp/fengmian_hu_7e8add7a2004bc1e.jpg 800w, /p/newstar-ctf-2025-crypto-wp/fengmian_hu_6317337569831f4b.jpg 1600w"
                        width="800" 
                        height="383" 
                        loading="lazy"
                        alt="Featured image of post NewStar CTF 2025 Crypto WP" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/wp/" style="background-color: #2a9d8f; color: #fff;">
                WP
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/newstar-ctf-2025-crypto-wp/">NewStar CTF 2025 Crypto WP</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            NewStar CTF 2025 Crypto æ–¹å‘é¢˜ç›®è§£æ
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published" datetime='2025-11-04T00:00:00Z'>Nov 04, 2025</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 33 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p><strong>å†™åœ¨å‰é¢çš„ä¸€äº›è¯</strong><br >
ç»§moectfä¹‹åæ‰“çš„ç¬¬äºŒåœºctfæ¯”èµ›ï¼Œå‰ä¸¤å‘¨ä¸»è¦åšäº†cryå’Œé€†å‘ï¼Œåé¢å°±åªåšäº†cryäº†ï¼Œå…¶ä»–æ–¹å‘éƒ½åšä¸åŠ¨äº†&hellip;<br >
è¿™æ¬¡çš„cryptoä¸€å…±24é“é¢˜ï¼Œå¤§éƒ¨åˆ†éš¾åº¦é€‚ä¸­ï¼Œ<del>æ²¡æœ‰ç‰¹åˆ«ç¹ççš„åˆ†ç»„å¯†ç é¢˜ç›®</del>ï¼Œç›¸æ¯”moeï¼Œéš¾åº¦ç›¸å·®ä¸å¤§ï¼Œæˆ–è€…è¯´ç¨å¾®éš¾ä¸€ç‚¹ï¼Œè€ƒçš„ä¸œè¥¿æ¶‰åŠçš„æ›´å¹¿ï¼Œå¦å¤–é‡è¦çš„ä¸€ç‚¹å°±æ˜¯ä¸åªæœ‰é™„ä»¶é¢˜ï¼Œè¿˜æœ‰è¿œç¨‹é¢˜ç›®ï¼Œè¶£å‘³æ€§ç›¸è¾ƒmoeç¡®å®æ›´é«˜ï¼Œæ€»ä¹‹è¿˜æ˜¯æŒºå¥½ç©çš„<br ></p>
<h2 id="week-1">Week 1
</h2><h3 id="å”¯ä¸€è¡¨ç¤º">å”¯ä¸€è¡¨ç¤º
</h3><p>è¿™é“é¢˜æ˜¯ä¸€ä¸ªä¸­å›½å‰©ä½™å®šç†çš„åº”ç”¨ï¼Œç”±è‹¥å¹²è¿ç»­çš„ç´ æ•°æ¢å¤nï¼Œè€Œé¢˜ç›®ä¸­remaindersç»™äº†ï¼Œå°±æ˜¯c<br >
ç”±cçš„é•¿åº¦ç­‰äºused_primesçš„é•¿åº¦ï¼Œå¯ä»¥æ¢å¤å‡ºused_primesï¼Œé‚£ä¹ˆå°±èƒ½ç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚å‡ºnï¼Œå³message_int<br ></p>
<p>exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sympy.ntheory.modular</span> <span class="kn">import</span> <span class="n">crt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">next_prime</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">13</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">129</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">194</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">155</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">primes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="n">primes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">    <span class="n">primes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">reconstructed</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">crt</span><span class="p">(</span><span class="n">primes</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">reconstructed</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{9c8589c2-aecb-4ec4-b027-654bc322e2d1}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å°è·³è›™">å°è·³è›™
</h3><p>é˜…è¯»é¢˜ç›®æºä»£ç åï¼Œå¾ˆå®¹æ˜“å°±èƒ½ç†è§£åœ¨å¹²ä»€ä¹ˆï¼Œå°±æ˜¯å¯¹ä¸€ä¸ªæ•°å¯¹(a,b)ä¸€ç›´åšè¿ç®—ï¼Œç›´åˆ°a=b<br >
å¯ä»¥å†™å‡ºä¸€ä¸ªç®€å•çš„è„šæœ¬ï¼Œè°ƒç”¨äº”æ¬¡å³å¯æ‹¿åˆ°flag<br >
flag{Go0d_j0b_t0_Cl34r_thi5_Diff3r3nt_t45k_4_u}<br ></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="mi">83934</span><span class="p">,</span> <span class="mi">76854</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åˆè¯†rsa">åˆè¯†RSA
</h3><p>é¦–å…ˆï¼Œç»™äº†keyçš„md5å€¼<code>KEY = b'5ae9b7f211e23aac3df5f2b8f3b8eada'</code>ï¼Œæ‰¾ä¸€ä¸ªåœ¨çº¿ç½‘ç«™è§£å¯†md5ï¼Œå¯ä»¥å¾—åˆ°<code>key = b'crypto'</code><br >
ç„¶åï¼Œç”±På’Œkeyç®—å‡ºpï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ†è§£näº†ï¼Œæ³¨æ„phi(n)çš„è®¡ç®—å…¬å¼å³å¯<br ></p>
<p>exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gmpy2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">P</span> <span class="o">=</span> <span class="mi">8950704257708450266553505566662195919814660677796969745141332884563215887576312397012443714881729945084204600427983533462340628158820681332200645787691506</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">44446616188218819786207128669544260200786245231084315865332960254466674511396013452706960167237712984131574242297631824608996400521594802041774252109118569706894250996931000927100268277762882754652796291883967540656284636140320080424646971672065901724016868601110447608443973020392152580956168514740954659431174557221037876268055284535861917524270777789465109449562493757855709667594266126482042307573551713967456278514060120085808631486752297737122542989222157016105822237703651230721732928806660755347805734140734412060262304703945060273095463889784812104712104670060859740991896998661852639384506489736605859678660859641869193937584995837021541846286340552602342167842171089327681673432201518271389316638905030292484631032669474635442148203414558029464840768382970333</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">42481263623445394280231262620086584153533063717448365833463226221868120488285951050193025217363839722803025158955005926008972866584222969940058732766011030882489151801438753030989861560817833544742490630377584951708209970467576914455924941590147893518967800282895563353672016111485919944929116082425633214088603366618022110688943219824625736102047862782981661923567377952054731667935736545461204871636455479900964960932386422126739648242748169170002728992333044486415920542098358305720024908051943748019208098026882781236570466259348897847759538822450491169806820787193008018522291685488876743242619977085369161240842263956004215038707275256809199564441801377497312252051117441861760886176100719291068180295195677144938101948329274751595514805340601788344134469750781845</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;crypto&#39;</span> <span class="c1"># åœ¨çº¿ç½‘ç«™è§£å¯†å¾—åˆ°</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">P</span> <span class="o">^</span> <span class="p">(</span><span class="n">bytes_to_long</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">isqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="nb">pow</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">q</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{W3lc0me_t0_4h3_w0rl4_0f_Cryptoooo!}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="éšæœºæ•°ä¹‹æ—…1">éšæœºæ•°ä¹‹æ—…1
</h3><p>è¿™é“é¢˜æ˜¯ä¸€ä¸ªçº¿æ€§åŒä½™ç”Ÿæˆå™¨ï¼Œå…³ç³»å¼ä¸º<code>hint[i+1] = (a * hint[i] + message_int) mod p</code><br >
å…¶ä¸­ï¼Œaï¼Œpï¼Œhintåºåˆ—éƒ½å·²çŸ¥ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ©ç”¨å‰ä¸¤ä¸ªhintå€¼å°±èƒ½æ±‚å‡ºæ˜æ–‡ï¼Œæ³¨æ„åˆ° message_int &lt; p<br >
<code>hint[1] = (a * hint[0] + message_int) mod p</code><br >
<code>hint[1] - a * hint[0] = message_int mod p</code></p>
<p>exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">295789025762601408173828135835543120874436321839537374211067344874253837225114998888279895650663245853</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="mi">516429062949786265253932153679325182722096129240841519231893318711291039781759818315309383807387756431</span>
</span></span><span class="line"><span class="cl"><span class="n">hint</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="mi">184903644789477348923205958932800932778350668414212847594553173870661019334816268921010695722276438808</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">289189387531555679675902459817169546843094450548753333994152067745494929208355954578346190342131249104</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">511308006207171169525638257022520734897714346965062712839542056097960669854911764257355038593653419751</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">166071289874864336172698289575695453201748407996626084705840173384834203981438122602851131719180238215</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">147110858646297801442262599376129381380715215676113653296571296956264538908861108990498641428275853815</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">414834276462759739846090124494902935141631458647045274550722758670850152829207904420646985446140292244</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">hint</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">hint</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{c3bc3ead-01e3-491b-aa2d-d2f042449fd6}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="sagemathä½¿ç”¨æŒ‡å“ª">Sagemathä½¿ç”¨æŒ‡å“ªï¼Ÿ
</h3><p>åœ¨sagemathä¸­è¿è¡Œé¢˜ç›®ç»™çš„é™„ä»¶ä»£ç å³å¯æ‹¿åˆ°flag<br >
flag{e142d08c-7e7d-43ed-b5ad-af51ffc512ee}<br >
è¿™ä¸ªé¢˜å®é™…ä¸Šæ˜¯åœ¨ä¸€ç›´ç”Ÿæˆä¸€äº›ç¾¤ï¼Œç„¶åorder()æ–¹æ³•è¿”å›ç¾¤çš„é˜¶ï¼Œä»¥æ­¤æ¥ç”Ÿæˆå¯†é’¥keyï¼Œè¿›è¡Œå¼‚æˆ–åŠ å¯†<br ></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># Sage 9.3
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">key=1
</span></span><span class="line"><span class="cl">G = PSL(2, 11)
</span></span><span class="line"><span class="cl">key*=G.order()
</span></span><span class="line"><span class="cl">G = CyclicPermutationGroup(11)
</span></span><span class="line"><span class="cl">key*=G.order()
</span></span><span class="line"><span class="cl">G = AlternatingGroup(114)
</span></span><span class="line"><span class="cl">key*=G.order()
</span></span><span class="line"><span class="cl">G = PSL(4, 7)
</span></span><span class="line"><span class="cl">key*=G.order()
</span></span><span class="line"><span class="cl">G = PSU(3, 4)
</span></span><span class="line"><span class="cl">key*=G.order()
</span></span><span class="line"><span class="cl">G = MathieuGroup(12)
</span></span><span class="line"><span class="cl">key*=G.order()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">c=91550542840025722520458836108112308924742424464072171170891749838108012046397534151231852770095499011
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">key=(int(str(bin(key))[2:][0:42*8],2))
</span></span><span class="line"><span class="cl">m=c^^key
</span></span><span class="line"><span class="cl">f=[]
</span></span><span class="line"><span class="cl">while m&gt;0:
</span></span><span class="line"><span class="cl">    x=m%256
</span></span><span class="line"><span class="cl">    f.append(chr(x))
</span></span><span class="line"><span class="cl">    m//=256
</span></span><span class="line"><span class="cl">f.reverse()
</span></span><span class="line"><span class="cl">flag=&#34;&#34;.join(i for i in f )
</span></span><span class="line"><span class="cl">print(flag)
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="week-2">Week 2
</h2><h3 id="ç½®æ¢">ç½®æ¢
</h3><p>è¿™é“é¢˜è€ƒå¯Ÿçš„å°±æ˜¯ç½®æ¢çš„æ¦‚å¿µä»¥åŠè¿ç®—<br >
é¢˜ç›®ç»™äº†ä¸€ä¸ªFï¼Œæ˜¯ä¸€ä¸ªçœ‹ç€å¾ˆé•¿çš„ç½®æ¢çš„è¿ç®—<br >
æˆ‘å†åšè¿™é“é¢˜çš„æ—¶å€™æ˜¯æ‹¿çº¸å’Œç¬”ç®—çš„&hellip;æ„Ÿè§‰ä¹ŸæŒºæ–¹ä¾¿ï¼Œæ³¨æ„ç½®æ¢æ˜¯ä»å³å¾€å·¦ç®—å°±è¡Œ<br >
æŠŠFç®—å‡ºæ¥ä¹‹åï¼Œåä¸€ä¸‹å°±æ˜¯Fçš„é€†å‡½æ•°ï¼Œæ¯”å¦‚è¯´Fæ˜¯1æ˜ å°„åˆ°4ï¼Œé‚£ä¹ˆFé€†å°±æŠŠ4æ˜ å°„åˆ°1<br >
æŠŠFé€†ç®—å‡ºæ¥ä¹‹å(æ‰¾ä¸åˆ°äº†&hellip;)ï¼Œæ‹¿è„šæœ¬æ±‚ä¸€ä¸‹ç»“æœ<br >
æ³¨æ„ç½®æ¢åªä½œç”¨ä¸€æ¬¡ï¼Œæ¯”å¦‚è¯´ï¼šå…ˆå¤„ç†çš„æ˜¯aæ˜ å°„æˆbï¼Œç„¶åå¤„ç†bæ˜ å°„æˆcçš„æ—¶å€™ï¼Œä¸èƒ½æŠŠåˆšæ‰aæ˜ å°„æˆçš„bä¹Ÿæ˜ å°„æˆcï¼Œè¦ä¸ç„¶å°±é”™äº†ï¼Œè¿™é‡Œç”¨çš„æ˜¯å¤§å°å†™çš„æ–¹æ³•é¿å…çš„<br ></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;SUFK_D_SJNPHA_PARNUTDTJOI_WJHH_GACJIJTAHY_IOT_STUNP_YOU.&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="c1"># SUCH_A_SIMPLE_PERMUTATION_WILL_DEFINITELY_NOT_STUMP_YOU.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{SUCH_A_SIMPLE_PERMUTATION_WILL_DEFINITELY_NOT_STUMP_YOU.}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="fhe-0-and-1">FHE: 0 and 1
</h3><p>é¢˜ç›®å…ˆå°†flagæ¯ä¸ªå­—ç¬¦è½¬æ¢ä¸º8ä½äºŒè¿›åˆ¶ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªå¤§ç´ æ•°pï¼Œä»¥pä¸ºåŸºç¡€éšæœºç”Ÿæˆä¸€ä¸ªå¤§æ•´æ•°ä½œä¸ºå…¬é’¥ï¼Œå»ä¸€ä½ä¸€ä½çš„åŠ å¯†flag<br >
æ³¨æ„åˆ°<code>pk_i = p * rand_multiplier + rand_offset</code>è¿™é‡Œçš„rand_offsetå¾ˆå°ï¼Œç„¶åå‰é¢çš„é‚£éƒ¨åˆ†æ˜¯pçš„å€æ•°ï¼Œé‚£ä¹ˆpå°±æ˜¯<code>pk_i - rand_offset</code>çš„å› å­ï¼Œæˆ‘ä»¬ç›´æ¥å°è¯•çˆ†ç ´ï¼Œç”¨gcdå‡½æ•°æ±‚å‡ºp<br ></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pk</span> <span class="o">=</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pk0</span> <span class="o">=</span> <span class="n">pk</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">pk1</span> <span class="o">=</span> <span class="n">pk</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">pk0</span> <span class="o">-=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">pk1</span> <span class="o">-=</span> <span class="n">j</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">GCD</span><span class="p">(</span><span class="n">pk0</span><span class="p">,</span> <span class="n">pk1</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">GCD</span><span class="p">(</span><span class="n">pk0</span><span class="p">,</span> <span class="n">pk1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">pk0</span> <span class="o">=</span> <span class="n">pk</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">pk1</span> <span class="o">=</span> <span class="n">pk</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># p = 232705849988154546719847649732849410619</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥æ±‚å‡ºpï¼Œè¿™é‡Œè¯•äº†å¥½å¤šæ•°æ®éƒ½å¯ä»¥ï¼Œå°±æ˜¯æ‹¿pk[0]å’Œpk[1]ä¸è¡Œï¼ŒæŒºå¥‡æ€ªçš„<br >
æ±‚å‡ºpä»¥åï¼Œæ³¨æ„åˆ°<code>c_i = int(bit) + small_noise + large_noise</code>ç­‰å¼å³è¾¹çš„large_noiseæ˜¯pçš„å€æ•°ï¼Œæ¨¡ä¸€ä¸‹pä¹‹åå°±æ²¡äº†ï¼Œè€Œsmall_noiseæ˜¯ä¸€ä¸ªå¶æ•°ï¼Œå†æ¨¡ä¸€ä¸ª2ä¹Ÿæ²¡äº†ï¼Œé‚£ä¹ˆå°±èƒ½æ ¹æ®å¥‡å¶æ€§åˆ¤æ–­å‡ºbitäº†<br ></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="mi">232705849988154546719847649732849410619</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">ci</span> <span class="o">%=</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">ci</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span> <span class="o">+=</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span> <span class="o">+=</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">flag1</span> <span class="o">=</span> <span class="p">[</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag</span><span class="p">),</span> <span class="mi">8</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag1</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{3235c1ab-6830-480f-b5e0-39be40b94a7d}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="rsa_revenge">RSA_revenge
</h3><p>é¢˜ç›®æŠŠflagæ‹†æˆä¸¤åŠå¹¶åˆ†åˆ«åŠ å¯†ï¼Œæˆ‘ä»¬éœ€è¦åˆ†åˆ«è§£å¯†å‰åå„ä¸€åŠ<br >
å‰åŠéƒ¨åˆ†çš„æ“ä½œæ˜¯é€‰å–3ä¸ªä¸åŒçš„å¤§ç´ æ•°ï¼Œç„¶åç´ å› å­è¢«éšæœºæå‡åˆ°2åˆ°7çš„å°å¹‚æ¬¡ï¼Œä¹˜èµ·æ¥å¾—åˆ°n1ï¼Œç„¶åå¯¹n1è¿›è¡ŒrsaåŠ å¯†ï¼Œè¾“å‡ºæœ‰ç´ å› å­åˆ—è¡¨ã€æ¨¡n1ã€å’Œå¯†æ–‡<br >
ç”±äºå¹‚æ¬¡å¾ˆå°ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥çˆ†ç ´ï¼Œåˆ†è§£nï¼Œæ±‚å‡ºphiï¼Œå³å¯æ¢å¤flagçš„å‰åŠéƒ¨åˆ†<br ></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span><span class="p">,</span> <span class="n">GCD</span>
</span></span><span class="line"><span class="cl"><span class="n">list1</span> <span class="o">=</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">n1</span> <span class="o">=</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">c1</span> <span class="o">=</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">n11</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">n11</span> <span class="o">*=</span> <span class="n">list1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="n">i</span>
</span></span><span class="line"><span class="cl">            <span class="n">n11</span> <span class="o">*=</span> <span class="n">list1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="n">j</span>
</span></span><span class="line"><span class="cl">            <span class="n">n11</span> <span class="o">*=</span> <span class="n">list1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="n">k</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">n11</span> <span class="o">==</span> <span class="n">n1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">n11</span> <span class="o">=</span> <span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œåå¾—åˆ°<br ></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span> <span class="p">,</span><span class="mi">7</span>
</span></span><span class="line"><span class="cl"><span class="n">phi1</span> <span class="o">=</span> <span class="n">list1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">list1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">list1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">list1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">list1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">6</span> <span class="o">*</span> <span class="p">(</span><span class="n">list1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{Ooooo6_y0u_kn0w_F3rm</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯¹äºååŠéƒ¨åˆ†ï¼Œéšæœºé€‰ä¸‰ä¸ªä¸åŒçš„å¤§ç´ æ•°å¹¶æŠŠå®ƒä»¬ç›¸ä¹˜å¾—åˆ°n2<br >
ç»™äº†<code>hint1 = pow(m, p2 * q2, n2)</code>å’Œ<code>hint2 = pow(m, r2, n2)</code>ï¼Œæˆ‘ä»¬æ¨å¯¼ä¸€ä¸‹<br >
</p>
$$
m^{p \cdot q} \equiv h_1 \pmod{n} \\
m^r \equiv h_2 \pmod{n}
$$<p>
å¯¹äºç¬¬äºŒä¸ªå¼å­ï¼Œç”±äºræ˜¯nçš„å› å­ï¼Œæ‰€ä»¥$m^r \equiv h_2 \pmod{r}$ï¼Œåˆræ˜¯ç´ æ•°ï¼Œç”±è´¹é©¬å®šç†å¯å¾—$m^r \equiv m^{r-1} * m  \equiv m \equiv h_2 \pmod{r}$ï¼Œç»“åˆ$m^e \equiv c \pmod{n}$ -&gt; $m^e \equiv c \pmod{r}$å¯å¾—$h_2^e \equiv c \pmod{r}$ï¼Œæ‰€ä»¥ræ˜¯n2å’Œ$h_2^e -c$çš„å…¬å› å­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨gcdå‡½æ•°æ±‚å‡ºr<br >
å¦ä¸€æ–¹é¢(p+q)æ˜¯å·²çŸ¥çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨n/rå¾—åˆ°(p*q)ï¼Œåˆ°è¿™é‡Œï¼Œphiå°±å¯ä»¥æ±‚å‡ºæ¥äº†<br ></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">r2</span> <span class="o">=</span> <span class="n">GCD</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span> <span class="n">hint2</span><span class="o">**</span><span class="n">e</span> <span class="o">-</span> <span class="n">c2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">phi2</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">p2q2</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">//</span> <span class="n">r2</span>
</span></span><span class="line"><span class="cl"><span class="n">phi2</span> <span class="o">*=</span> <span class="p">(</span><span class="n">p2q2</span> <span class="o">-</span> <span class="n">hint3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @t_and_Eu13r_v3ry_w3ll!!}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¾—åˆ°å®Œæ•´flag<code>flag{Ooooo6_y0u_kn0w_F3rm@t_and_Eu13r_v3ry_w3ll!!}</code></p>
<h3 id="ç¾¤è®ºå°æµ‹è¯•">ç¾¤è®ºå°æµ‹è¯•
</h3><p>è¿™é“é¢˜è€ƒçš„æ˜¯å¯¹ç¾¤çš„ç±»å‹çš„åˆ¤æ–­ï¼Œéœ€è¦åˆ¤æ–­å¯¹äº”ä¸ªç¾¤çš„ç±»å‹å°±èƒ½æ‹¿åˆ°flagï¼Œæœ‰ç‚¹åƒå°è·³è›™é‚£é“é¢˜ï¼Œä¸è¿‡è¿™é“é¢˜æœ‰ä¸ªå¥½å¤„æ˜¯å³ä½¿ç­”é”™äº†ä¹Ÿä¸ä¼šç»ˆæ­¢ï¼Œè¿˜èƒ½ç»§ç»­ç­”ï¼Œå¹¶ä¸”è¿›åº¦ä¹Ÿä¸ä¼šæ¸…0ï¼Œè¿™å°±æœ‰ä¸ªéé¢„æœŸï¼Œä¸€ç›´ç›²çŒœCnå¤šè¯•å‡ æ¬¡å°±èƒ½è¿‡&hellip;<br >
<code>flag{I_v3_b3c0m3_@n_e^3Rt_in_gr0up_7h30ry_@Ft3r_5o1ving_7hi5_+++bl3m!!!}</code>
å¥½å§ï¼Œè¿˜æ˜¯çœ‹ä¸€ä¸‹è¿™ä¸ªé¢˜å§ï¼Œç»™äº†å‡ ç§ç±»å‹çš„ç¾¤<br ></p>
<ul>
<li>né˜¶å¾ªç¯ç½®æ¢ç¾¤</li>
<li>é˜¿è´å°”ç¾¤</li>
<li>å¯¹ç§°ç¾¤</li>
<li>äºŒé¢ä½“ç¾¤</li>
<li>å››å…ƒæ•°ç¾¤</li>
<li>äº¤é”™ç¾¤</li>
</ul>
<p>æ¯æ¬¡ä¼šè¾“å‡ºä¸€ä¸ªn*nçš„è¡¨æ ¼ï¼Œæˆ‘ä»¬çŸ¥é“ç¾¤æ˜¯ç”±ä¸€ä¸ªé›†åˆå’Œä¸€ç§è¿ç®—ç»„æˆçš„ï¼Œè¿™ä¸ªè¡¨æ ¼å°±æ˜¯ç¾¤çš„è¿ç®—ç»“æœè¡¨<br >
æ²¡å­¦è¿‡ç¾¤è®ºï¼Œè¿™äº›æ¦‚å¿µå¥½å¤šéƒ½ä¸æ‡‚&hellip;æ‚² (<br >
ä¸è¿‡æ—¢ç„¶æºä»£ç åˆ©ç”¨äº†sagemathï¼Œç†è®ºä¸Šæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨sagemathæ¥åˆ¤æ–­?<br >
é˜¿è´å°”ç¾¤æ¯”è¾ƒå¥½åˆ¤æ–­ï¼Œçœ‹æ˜¯å¦æ»¡è¶³äº¤æ¢å¾‹å³å¯<br >
åé¢çš„å°±è¦å»çœ‹å…ƒç´ çš„é˜¶å’Œå…¶ä»–ä¸œè¥¿ç»“åˆç‰¹å®šç¾¤çš„å®šä¹‰æ¥åˆ¤æ–­äº†<br ></p>
<h3 id="dlp_1">DLP_1
</h3><p>DLPï¼Œå³ç¦»æ•£å¯¹æ•°é—®é¢˜<br >
è¿™é“é¢˜ç›®æ˜¯å¯¹flagå¤§æ‹¬å·ä¸­é—´çš„å†…å®¹è¿›è¡Œäº†åˆ†ä¸‰æ®µçš„åŠ å¯†ï¼Œå…³é”®æ˜¯è¿™ä¸€å¥<code>pow(g[i],x,p[i])</code>xæ˜¯æˆ‘ä»¬éœ€è¦æ±‚çš„ï¼Œè€Œxåœ¨æŒ‡æ•°ä½ç½®ä¸Šï¼Œæ‰€ä»¥æ±‚xçš„é—®é¢˜å°±å«åšç¦»æ•£å¯¹æ•°é—®é¢˜<br >
å¯¹äºç¦»æ•£å¯¹æ•°é—®é¢˜ï¼Œæˆ‘ä»¬é‡‡ç”¨ç»å…¸çš„bsgsç®—æ³•æ¥è§£å†³<br >
ç›´æ¥ä¸Šè„šæœ¬<br ></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">bsgs</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span> <span class="c1"># a ** x = b (mod m)</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">isqrt</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">%=</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">%=</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="n">isqrt</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">value</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="n">an</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cur</span> <span class="o">=</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">value</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">        <span class="n">cur</span> <span class="o">=</span> <span class="n">cur</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">    <span class="n">cur</span> <span class="o">=</span> <span class="n">an</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">cur</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">p</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="n">value</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">cur</span> <span class="o">=</span> <span class="n">cur</span> <span class="o">*</span> <span class="n">an</span> <span class="o">%</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">189869646048037</span><span class="p">,</span> <span class="mi">255751809593851</span><span class="p">,</span> <span class="mi">216690843046819</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="mi">78860859934701</span><span class="p">,</span> <span class="mi">89478248978180</span><span class="p">,</span> <span class="mi">81479747246082</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">m1</span> <span class="o">=</span> <span class="n">bsgs</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">m2</span> <span class="o">=</span> <span class="n">bsgs</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">m3</span> <span class="o">=</span> <span class="n">bsgs</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">h</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span> <span class="o">+</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span> <span class="o">+</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{I_l0v3_DLPPPPP^.^!}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="week3">Week3
</h2><h3 id="æ¬§çš‡çš„ç”Ÿæ—¥">æ¬§çš‡çš„ç”Ÿæ—¥
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">22</span>  
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">Hash</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">%</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Find a collision: give me two different numbers x1, x2 with Hash(x1)=Hash(x2).&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Input Format: x1 x2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">5000</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Need two numbers!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Invalid input&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">x1</span> <span class="o">%=</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">    <span class="n">x2</span> <span class="o">%=</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">x1</span> <span class="o">!=</span> <span class="n">x2</span> <span class="ow">and</span> <span class="n">Hash</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">==</span> <span class="n">Hash</span><span class="p">(</span><span class="n">x2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;x&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">Hash</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span><span class="n">Hash</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸€é“å“ˆå¸Œç¢°æ’çš„é¢˜ç›®ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸¤ä¸ªä¸åŒçš„æ•°x1å’Œx2ä½¿å¾—Hash(x1)=Hash(x2)ï¼Œå…¶ä¸­Hashå‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼Œæ˜¯ä¸€ä¸ªæ¨¡mæ„ä¹‰ä¸‹çš„äºŒæ¬¡å‡½æ•°<br ></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">Hash</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">%</span> <span class="n">m</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ä¸­må·²çŸ¥ï¼Œä¸º2**22ï¼Œabcä¸‰ä¸ªå‚æ•°æœªçŸ¥ï¼Œè¾“å…¥ä¼šåšä¸€ä¸ªæ¨¡mçš„å¤„ç†<code>x1 %= m</code> <code>x2 %= m</code> <br>
æˆ‘ä»¬å…ˆå°è¯•å‡ ä¸ªç‰¹æ®Šæ•°å­—0ï¼Œ1ï¼Œ-1ï¼Œè¿™æ ·å°è¯•åå¯ä»¥å¾—åˆ°aï¼Œ(a+b+c)ï¼Œ(a-b+c)è¿™ä¸‰ä¸ªæ•°æ¨¡mçš„å€¼<br>
ç„¶åç®€å•åŒ–ç®€ä¸€ä¸‹ï¼Œå°±èƒ½æ‹¿åˆ°aï¼Œbï¼Œcæ¨¡mçš„å€¼ï¼Œäº‹å®ä¸Šæˆ‘ä»¬ä»æºä»£ç é‡Œå¯ä»¥çœ‹åˆ°è¿™ä¸‰ä¸ªæ•°éƒ½æ˜¯å°äºmçš„ï¼Œå…¶å®å°±æ˜¯æ±‚å‡ºäº†abcè¿™ä¸‰ä¸ªæ•°çš„å€¼<br>
ç„¶åï¼Œæ¨å¯¼ä¸€ä¸‹
</p>
$$
a \cdot x_1^2 + b \cdot x_1 + c \equiv a \cdot x_2^2 + b \cdot x_2 + c \pmod{m} \\
a \cdot (x_1 + x_2)(x_1 - x_2) + b \cdot (x_1 - x_2) \equiv 0 \pmod{m}
$$<p>
åˆ°è¿™é‡Œï¼Œè¿˜ä¸èƒ½ç›´æ¥æŠŠ(x1-x2)ç»™çº¦æ‰ï¼Œå› ä¸ºç›´æ¥çº¦çš„è¯æ¨¡æ•°mä¹Ÿå¾—é™¤ä¸€ä¸ªgcd(m,x1-x2)<br>
ä¸è¿‡æˆ‘ä»¬å…ˆè€ƒè™‘ä¸€ä¸ªç®€å•çš„æƒ…å†µï¼Œå°±æ˜¯gcd(m,x1-x2)=1
</p>
$$
a \cdot (x_1 + x_2) + b  \equiv 0 \pmod{m} \\
(x_1 + x_2) \equiv a^{-1} \cdot (-b) \pmod{m}
$$<p>
æƒ³è¦è¿™æ ·å­é¡ºåˆ©ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬é€‰å–x1å’Œx2çš„æ—¶å€™æ³¨æ„x1-x2ä¸æ˜¯å¶æ•°å°±è¡Œ<br>
ä¸‹é¢æ˜¯ä¸€ç»„æ•°æ®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">c = 970212 mod m
</span></span><span class="line"><span class="cl">a + b + c = 1631836 mod m
</span></span><span class="line"><span class="cl">a - b + c = 3197842 mod m
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">a = 1444627
</span></span><span class="line"><span class="cl">b = 3411301
</span></span><span class="line"><span class="cl">c = 970212
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">inv_a = 4028187 # aä¸ä¸€å®šæœ‰é€†å…ƒï¼Œå¤šè¯•å‡ æ¬¡
</span></span><span class="line"><span class="cl">-b = 783003
</span></span><span class="line"><span class="cl">x1 + x2 = 3646297
</span></span><span class="line"><span class="cl">æˆ‘ä»¬å–
</span></span><span class="line"><span class="cl">x1 = 1823148
</span></span><span class="line"><span class="cl">x2 = 1823149 # x2 - x1 = 1
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>flag{-----you---are----so++++lucky+++++}</code></p>
<h3 id="gcl">GCL
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">uuid</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="o">=</span><span class="s2">&#34;flag{&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span><span class="o">+</span><span class="s2">&#34;}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span><span class="o">=</span><span class="n">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">length</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">gift</span><span class="o">=</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">=</span><span class="n">getPrime</span><span class="p">(</span><span class="n">length</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">gift</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">inverse</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">p</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">s</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">gift</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">gift</span><span class="o">=</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">            <span class="n">s</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">key</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">inverse</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">p</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">m</span><span class="o">^</span><span class="n">key</span><span class="p">,</span><span class="n">gift</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="p">,</span><span class="n">gift</span><span class="o">=</span><span class="n">encrypt</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;c=&#34;</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;gift=&#34;</span><span class="p">,</span><span class="n">gift</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">c= 18160008429568445340421193226402615775962630020115351294214303830750860843808409781742323237344243089
</span></span></span><span class="line"><span class="cl"><span class="s2">gift= [131865585354798388503853664204045577497186238155562615801484830104683890877181087005834317031942408283, 109059933499981578098773732552241207995570220834770592696583461488231579239704140357451421969855041379, 98201806091494704187082836852065059816140437191793644297243874711016194459625411781009291718075199135, 18757271931319533257322147585629190099147626954402651433709338855513752753972712032016018862573500407, 44414575833831572247180084691462875843855281105693674992974405001127527490917389843309074213475473796, 119230797767846495009095216222595719657467391997837145037599770904490776264420156248960485317227292047, 55025298938239176714746988606097305944000798467396224542466354530737718336537150422546120714654987068, 61108071970379547679922902146574052023820080507110885404335008795305785800023228103358713867748030391, 73121196162106845765032066055951000614569505693120119413603886103757507878101072263238094066564654117, 41442768650713930642944746020790921582963259300977583069055974755273373804142970727737438848232141888]
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ˜¯ä¸€é“çº¿æ€§åŒä½™ç”Ÿæˆå™¨çš„é¢˜ç›®(LCG)ï¼Œä½†æ˜¯é€’æ¨å¼æœ‰æ‰€å˜åŒ–<code>s = (a * inverse(s, p) + b) % p</code>å¤šäº†ä¸€æ­¥æ±‚é€†çš„æ“ä½œï¼Œæœ‰ç‚¹åƒéšæœºæ•°1.9çš„å‡çº§ç‰ˆï¼Œæ€è·¯æ˜¯ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯a,b,på‡æœªçŸ¥ï¼Œä¸»è¦ä»é€’æ¨å¼å…¥æ‰‹åšå…¬å¼æ¨å¯¼ï¼Œæœ‰ç‚¹åƒé«˜ä¸­æ•°åˆ—é¢˜ç›®ï¼Œä¸‹é¢æ¨å¯¼æ±‚è§£a,b,pçš„æ–¹æ³•(æ•²è¿™å…¬å¼å¤ªç´¯äº†QAQ)
</p>
$$
\text{gift}[10] = [s_1, s_2, \dots, s_{10}] (æ³¨æ„è¿™é‡Œçš„ä¸‹æ ‡ä»1å¼€å§‹)\\
\begin{cases}
s_{n+1} \equiv (a \cdot s_n^{-1} + b) \mod p \\
s_{n+2} \equiv (a \cdot s_{n+1}^{-1} + b) \mod p \\
\end{cases} 
$$<p>
å¯¹è¿™ä¸¤ä¸ªå¼å­ï¼Œä¸¤è¾¹åŒä¹˜å³è¾¹çš„é€†å…ƒå¯å¾—
</p>
$$
\begin{cases}
s_{n+1} \cdot s_{n} \equiv a + b \cdot s_{n} \pmod{p} \\
s_{n+2} \cdot s_{n+1} \equiv a + b \cdot s_{n+1} \pmod{p}
\end{cases}
$$<p>
å¯¹ä¸Šé¢ç¬¬ä¸€ä¸ªå¼å­ä¸¤è¾¹åŒä¹˜s_n+1ï¼Œç¬¬äºŒä¸ªå¼å­ä¸¤è¾¹åŒä¹˜s_nï¼Œç„¶ååšå·®ï¼Œç›®çš„æ˜¯æ¶ˆå»å¸¦bçš„é¡¹
</p>
$$
\begin{cases}
(s_{n+1})^2 \cdot s_n \equiv a \cdot s_{n+1} + b \cdot s_n \cdot s_{n+1} \pmod{p} \\
s_{n+2} \cdot s_{n+1} \cdot s_n \equiv a \cdot s_n + b \cdot s_{n+1} \cdot s_n \pmod{p}\\
\end{cases} \\
s_{n+1} \cdot s_n \cdot(s_{n+2} - s_{n+1})\equiv a  (s_n - s_{n+1}) \equiv -a  (s_{n+1} - s_n) \pmod{p}
$$<p>è®°$ t_n = s_{n+1} - s_n$ï¼Œå¯å¾—</p>
$$
\begin{cases}
s_{n+1} \cdot s_n \cdot t_{n+2} \equiv  -at_{n+1} \pmod{p} \\
s_{n} \cdot s_{n-1} \cdot t_{n+1} \equiv  -at_n \pmod{p}
\end{cases} \\
$$<p>
ç¬¬ä¸€ä¸ªå¼å­ä¸¤è¾¹ä¹˜$s_ns_{n-1}$ï¼Œç„¶åä¸¤è¾¹åŒä¹˜tn
</p>
$$
s_{n+1} \cdot s_n \cdot t_{n+2}  \cdot (s_ns_{n-1}) \equiv  -at_{n+1} \cdot (s_ns_{n-1}) \equiv -a \cdot (-at_n) \equiv a^2t_n \pmod{p}
$$<p>
ä¸¤è¾¹åŒä¹˜$t_n$
</p>
$$
s_{n+1} \cdot s_n \cdot t_{n+2}  \cdot (s_ns_{n-1}) \cdot t_n \equiv   a^2t_n^2 \equiv (-at_n)^2  \equiv (s_ns_{n-1}t_{n+1})^2 \pmod{p} \\
=> (s_{n+1}s_n) \cdot t_{n+2} \cdot t_n  \equiv (s_ns_{n-1})t_{n+1}^2 \pmod{p} \\
å†å†™ä¸€å¼ (s_{n+2}s_{n+1}) \cdot t_{n+1} \cdot t_{n+3}  \equiv (s_{n+1}s_n)t_{n+2}^2 \pmod{p}
$$<p>ç°åœ¨ä¸¤ä¸ªå¼å­ä¸­ä»¥åŠæŠŠaå’Œbå…¨æ¶ˆå»äº†ï¼Œå‰©ä¸‹çš„å…¨æ˜¯å·²çŸ¥é‡ï¼Œä»£å…¥nï¼Œç”¨gcdå‡½æ•°å³å¯æ±‚å‡ºp
æœ‰äº†pä¹‹åï¼Œæ±‚aå’Œbå°±ç®€å•äº†ï¼Œåªéœ€è¦ä»£å›ä¸Šé¢çš„æŸäº›å¼å­å³å¯
å…·ä½“åœ¨ç”¨gcdæ±‚pçš„æ—¶å€™ï¼Œå‘ç°èƒ½æ±‚å‡ºæ¥å¥½å‡ ä¸ªå¤§æ•°ï¼Œä½†éƒ½ä¸æ˜¯ç´ æ•°ï¼Œä½†æ˜¯è¿™å‡ ä¸ªå¤§æ•°çš„å…¬å› å­æ˜¯pï¼Œæœ‰ç‚¹å¥‡æ€ª</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp1</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp2</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp3</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">T1</span> <span class="o">=</span> <span class="n">tmp2</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">tmp1</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="n">T2</span> <span class="o">=</span> <span class="n">tmp3</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">tmp2</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">GCD</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">isPrime</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å‘ç°è¾“å‡ºä¸€ç³»åˆ—å¤§æ•°ï¼Œä½†æ˜¯éƒ½ä¸æ˜¯ç´ æ•°</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å–äº†å…¶ä¸­ä¸¤ä¸ªå†æ±‚gcd</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">GCD</span><span class="p">(</span><span class="mi">401472189524218142101995883448864287482783058391244724871508835559039668303295079311080270663218422601</span><span class="p">,</span><span class="mi">535296252698957522802661177931819049977044077854992966495345114078719557737726772414773694217624563468</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">isPrime</span><span class="p">(</span><span class="mi">133824063174739380700665294482954762494261019463748241623836278519679889434431693103693423554406140867</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Trueï¼Œä¹Ÿå¯ä»¥å¤šè¯•å‡ ç»„æ•°æ®ï¼Œç»“æœä¸€æ ·</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‰©ä½™exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">18160008429568445340421193226402615775962630020115351294214303830750860843808409781742323237344243089</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span> <span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">131865585354798388503853664204045577497186238155562615801484830104683890877181087005834317031942408283</span><span class="p">,</span><span class="mi">109059933499981578098773732552241207995570220834770592696583461488231579239704140357451421969855041379</span><span class="p">,</span><span class="mi">98201806091494704187082836852065059816140437191793644297243874711016194459625411781009291718075199135</span><span class="p">,</span><span class="mi">18757271931319533257322147585629190099147626954402651433709338855513752753972712032016018862573500407</span><span class="p">,</span><span class="mi">44414575833831572247180084691462875843855281105693674992974405001127527490917389843309074213475473796</span><span class="p">,</span><span class="mi">119230797767846495009095216222595719657467391997837145037599770904490776264420156248960485317227292047</span><span class="p">,</span><span class="mi">55025298938239176714746988606097305944000798467396224542466354530737718336537150422546120714654987068</span><span class="p">,</span><span class="mi">61108071970379547679922902146574052023820080507110885404335008795305785800023228103358713867748030391</span><span class="p">,</span><span class="mi">73121196162106845765032066055951000614569505693120119413603886103757507878101072263238094066564654117</span><span class="p">,</span><span class="mi">41442768650713930642944746020790921582963259300977583069055974755273373804142970727737438848232141888</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">))]</span>
</span></span><span class="line"><span class="cl"><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># è¿™é‡Œgå’Œtéƒ½åœ¨å¼€å§‹åŠ äº†ä¸€ä¸ª0ï¼Œç›®çš„æ˜¯ä½¿å¾—å’Œæ¨å¯¼ä¸­çš„ä¸‹æ ‡å¯¹åº”ä¸Šï¼Œå¥½å†™ä»£ç </span>
</span></span><span class="line"><span class="cl"><span class="c1"># pä»ä¸Šé¢çš„ä»£ç ä¸­æ±‚å‡º</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="mi">133824063174739380700665294482954762494261019463748241623836278519679889434431693103693423554406140867</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">g</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="n">c</span> <span class="o">^</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{2eac1c79-8abd-465e-82f4-96beffed69e4}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="éšæœºæ•°ä¹‹æ—…3">éšæœºæ•°ä¹‹æ—…3
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sage" data-lang="sage"><span class="line"><span class="cl"><span class="c1"># Sage 9.3</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">uuid</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="o">=</span><span class="s2">&#34;flag{&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span><span class="o">+</span><span class="s2">&#34;}&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="n">random_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">A</span><span class="o">=</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">p</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="n">vector</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">b</span><span class="o">=</span><span class="n">A</span><span class="o">*</span><span class="n">x</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;output.txt&#34;</span><span class="p">,</span><span class="s2">&#34;w&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">A</span><span class="p">))</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç®€è¦åˆ†æ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sage" data-lang="sage"><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">p</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">x</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Aæ˜¯ä¸€ä¸ªm*nçš„çŸ©é˜µï¼Œxæ˜¯ä¸€ä¸ªnç»´å‘é‡ï¼Œåˆ™bæ˜¯ä¸€ä¸ªmç»´å‘é‡ï¼Œç°å·²çŸ¥Aï¼Œbï¼Œpï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ±‚å‡ºxå‘é‡<br>
ç”±b = A * xå¯æ„é€ ä¸€ä¸ªæ–¹ç¨‹ç»„ï¼Œæœ‰m = n - 1ä¸ªæ–¹ç¨‹ï¼Œnä¸ªæœªçŸ¥æ•°ï¼Œçœ‹ä¸Šå»æ˜¯ä¸€ä¸ªæ¬ å®šæ–¹ç¨‹ç»„ï¼Œä½†æ˜¯å…¶å®é¢˜ç›®ç»™äº†flagçš„æ ¼å¼&rsquo;flag{&hellip;}&lsquo;ä¹Ÿå°±æ˜¯è¯´xçš„å†…å®¹æˆ‘ä»¬å¹¶éå…¨éƒ¨æœªçŸ¥ï¼ŒæŠŠç¬¬ä¸€ä¸ªå­—ç¬¦&rsquo;f&rsquo;å½“æˆå·²çŸ¥é‡ï¼Œè§£ä¸€ä¸ª(n-1)å…ƒçš„æ–¹ç¨‹ç»„å³å¯<br>
æˆ‘ä»¬æŠŠAçš„ç¬¬ä¸€åˆ—æ‹å‡ºå»ï¼Œç»“åˆçº¿ä»£ä¸­çŸ©é˜µå’Œå‘é‡ç›¸ä¹˜çš„çŸ¥è¯†ç¨æ”¹ä¸€ä¸‹bå‘é‡å³å¯
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sage" data-lang="sage"><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="mi">5323</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">A</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">t</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">A1</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">A1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x0</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f&#39;</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x0</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{1f59622f-ccbc-45c0-b9f5-731a51343027}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cbcä¹‹èˆ">CBCä¹‹èˆ
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">BLOCK_SIZE</span> <span class="o">=</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">iv2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#flagä¸ºm2çš„éƒ¨åˆ†å†…å®¹</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">padded_m2</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">padded_m2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">c2</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">padded_m2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c2_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">c2</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">c2</span><span class="p">),</span> <span class="mi">16</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c2_blocks</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#å¶ä¸ï¼Œè¿™æ®µä¸åº”è¯¥è¢«ä½ ä»¬çœ‹è§çš„</span>
</span></span><span class="line"><span class="cl"><span class="c1"># perm = [1, 2, 3, 0]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># random.shuffle(perm)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># while any(i == perm[i] for i in range(4)):</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     random.shuffle(perm)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">c1_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">c2_blocks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">perm</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">c1</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c1_blocks</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">iv1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m1</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;IV1 (hex):&#34;</span><span class="p">,</span> <span class="n">iv1</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;IV2 (hex):&#34;</span><span class="p">,</span> <span class="n">iv2</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;m1 (hex):&#34;</span><span class="p">,</span> <span class="n">m1</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;c1 (hex):&#34;</span><span class="p">,</span> <span class="n">c1</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;c2 (hex):&#34;</span><span class="p">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">IV1 (hex): 1e5d251ea78ef68a1282079fd028c747
</span></span></span><span class="line"><span class="cl"><span class="s2">IV2 (hex): 18777ae4c1a29f4c5db8ba6c5dfe72f1
</span></span></span><span class="line"><span class="cl"><span class="s2">m1 (hex): f560fd28ed5c5ce7d952eb44b47007e702f42dbb54540dfc78467f48933dbb01ebcf520fd3d23a211d3b4e8c06261966cb178525c25b8058ff792e0f251d3d15
</span></span></span><span class="line"><span class="cl"><span class="s2">c1 (hex): caf7bc1223c17f848aec854a87b8958d4c518f7287663bfae0b6a5a1e0f0eb95b50c9ea6789a7d77fda5f50d1b8a2183b40cab693ebacf32a9b59faf3b0084ff
</span></span></span><span class="line"><span class="cl"><span class="s2">c2 (hex): b40cab693ebacf32a9b59faf3b0084ffcaf7bc1223c17f848aec854a87b8958db50c9ea6789a7d77fda5f50d1b8a21834c518f7287663bfae0b6a5a1e0f0eb95
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è€ƒå¯ŸAES-CBCåˆ†ç»„å¯†ç çš„é¢˜ç›®ï¼Œé¢˜ç›®çš„æ„æ€æ˜¯m2ä¸ºflagæ˜æ–‡ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰AESåŠ å¯†åçš„å¯†æ–‡c2å’Œiv2ï¼Œå¯†é’¥æœªçŸ¥ <br >
ä»¥åŠå¦ä¸€ç»„å¯†æ–‡c1ï¼Œåç§»é‡iv1ï¼Œå’Œç”¨ç›¸åŒå¯†é’¥è§£å¯†çš„æ˜æ–‡m1
å…³é”®åœ¨äºè¿™æ®µä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å¶ä¸ï¼Œè¿™æ®µä¸åº”è¯¥è¢«ä½ ä»¬çœ‹è§çš„</span>
</span></span><span class="line"><span class="cl"><span class="n">perm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="nb">any</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µä»£ç è¯´æ˜c1å’Œc2å¤§å°éƒ½æ˜¯4ä¸ªå—ï¼Œå¹¶ä¸”c1æ˜¯c2çš„4ä¸ªå—çš„æŸç§æ’åˆ—ç»„åˆ<br >
è¿™æ ·çš„æ’åˆ—ç»„åˆçš„ç‰¹ç‚¹æ˜¯permçš„4ä¸ªç´¢å¼•å’Œç´¢å¼•å¯¹åº”çš„å€¼éƒ½ä¸ç›¸ç­‰ï¼Œ<del>é‚£æˆ‘ä»¬å¯ä»¥æšä¸¾å‡ºæ‰€æœ‰çš„å¯èƒ½æƒ…å†µï¼Œç„¶åå»éå†</del>ï¼Œå†™wpçš„æ—¶å€™çªç„¶æ„è¯†åˆ°ï¼Œc1å’Œc2éƒ½çŸ¥é“ï¼Œé‚£æˆ‘ä»¬ç›´æ¥æ¯”å¯¹ä¸€ä¸‹ä¸å°±ç›´æ¥ç¡®å®šå‡ºpermäº†&hellip;å½“æ—¶è¿˜å› ä¸ºéå†æ‰€æœ‰æƒ…å†µï¼Œä»£ç ä¸€ç›´æœ‰bugï¼Œå¥½å§ï¼Œé‚£ä¹ˆpremå°±æ˜¯[1, 3, 2, 0]
æ¥ä¸‹æ¥ï¼Œéœ€è¦å¯¹CBCæ¨¡å¼æœ‰ä¸€äº›äº†è§£ï¼Œè¿™é‡Œå°±ä¸å…·ä½“å†™äº†ï¼Œç”±c1å’Œc2çš„å¯¹åº”å…³ç³»ç›´æ¥ç»™å‡ºå…¬å¼
è®°æ˜æ–‡m2 = [F0, F1, F2, F3], m1 = [A, B, C, D]
</p>
$$
\begin{cases}
A \oplus \text{iv}_1 = D(C_2[1]) \\
B \oplus C_2[1] = D(C_2[3]) \\
C \oplus C_2[3] = D(C_2[2]) \\
D \oplus C_2[2] = D(C_2[0]) \\
\end{cases} \\
\begin{cases}
D(C_2[1]) \oplus C_2[0] = \text{F}_1 \\
D(C_2[3]) \oplus C_2[2] = \text{F}_3 \\
D(C_2[2]) \oplus C_2[1] = \text{F}_2 \\
D(C_2[0]) \oplus \text{iv}_2 = \text{F}_0 \\
\end{cases} 
$$<p>
expï¼Œå…¬å¼å†™æ¸…æ¥šåå¯ä»¥ç›´æ¥ä¸ç”¨c1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">IV1</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s1">&#39;1e5d251ea78ef68a1282079fd028c747&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">IV2</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s1">&#39;18777ae4c1a29f4c5db8ba6c5dfe72f1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m1</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s1">&#39;f560fd28ed5c5ce7d952eb44b47007e702f42dbb54540dfc78467f48933dbb01ebcf520fd3d23a211d3b4e8c06261966cb178525c25b8058ff792e0f251d3d15&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c2</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s1">&#39;b40cab693ebacf32a9b59faf3b0084ffcaf7bc1223c17f848aec854a87b8958db50c9ea6789a7d77fda5f50d1b8a21834c518f7287663bfae0b6a5a1e0f0eb95&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c2_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">c2</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">c2</span><span class="p">),</span> <span class="mi">16</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">m1_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">m1</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">m1</span><span class="p">),</span> <span class="mi">16</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xor</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span> <span class="o">+=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">tmp</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">prem</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">tmp1</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">m1_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">IV1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">tmp2</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">m1_blocks</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c2_blocks</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">tmp3</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">m1_blocks</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c2_blocks</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">tmp4</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">m1_blocks</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">c2_blocks</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f1</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">tmp1</span><span class="p">,</span> <span class="n">c2_blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">f3</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">tmp2</span><span class="p">,</span> <span class="n">c2_blocks</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">f2</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">tmp3</span><span class="p">,</span> <span class="n">c2_blocks</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">f0</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">tmp4</span><span class="p">,</span> <span class="n">IV2</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">f0</span> <span class="o">+</span> <span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">f3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{cbc_dancing_1s_the_best_XD_miaowu~_wangang~}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä¹Ÿå¯ä»¥æ‰“å°çœ‹ä¸€ä¸‹ï¼Œf3çš„åé¢ç¡®å®æ˜¯æœ‰å¡«å……</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è¢«æ³„éœ²çš„ç´ æ•°">è¢«æ³„éœ²çš„ç´ æ•°
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gmpy2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nbits</span> <span class="o">=</span> <span class="mi">2048</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="n">nbits</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="n">nbits</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p_bits</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">high_bit_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p_bits</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 682</span>
</span></span><span class="line"><span class="cl"><span class="n">p_high</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">p_bits</span> <span class="o">-</span> <span class="n">high_bit_count</span><span class="p">)</span>  <span class="c1"># 342</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">high_bit_count</span> <span class="o">-</span> <span class="s1">&#39;?&#39;</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">p_high_masked</span> <span class="o">=</span> <span class="n">p_high</span> <span class="o">&amp;</span> <span class="n">mask</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;public_key.pem&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="se">\n</span><span class="s2">e = </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;partial_p.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">hex_str</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">p_high_masked</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;???&#34;</span> <span class="o">+</span> <span class="n">hex_str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="p">),</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;ciphertext.bin&#34;</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é“é¢˜ç›®è€ƒå¯Ÿç”¨Copper Smithæ–¹æ³•æ¢å¤å®Œæ•´çš„pï¼Œé™„ä»¶ç»™äº†å››ä¸ªæ–‡ä»¶<br></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">public_key.pem å¯ç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œå¾—åˆ°å…¬é’¥nå’Œe
</span></span><span class="line"><span class="cl">ciphertext.bin å¯ç”¨010æ‰“å¼€ï¼Œæ‹¿åˆ°åŠ å¯†åçš„åå…­è¿›åˆ¶æ•°æ®
</span></span><span class="line"><span class="cl">partial_p.txt pçš„éƒ¨åˆ†å†…å®¹
</span></span><span class="line"><span class="cl">the obscured prime.py é¢˜ç›®æºä»£ç 
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…ˆç®€å•å¤„ç†ä¸€ä¸‹æ•°æ®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">21934359804505952036862374470121480969133157443403593676896735938967557380443712142948340045099502553395200377704119756795591494784154969814547228557820800704252137319116648069964954630897500682893049024415124688093092305470777707518715866086606412935218188227137641451025015198528792875781144610650284639622563092129651357421263335843442984066367152832534441036576325851144177987730637618561519998767356432693944920792456483071919398611969079921679238886430086602278453518529089393964226042148309150493671461870755024341916271456658974034765995703658414257129652933251962572776586195115459121872074657802310744772937</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;4A F7 F2 8F B6 E2 69 7C D4 40 03 4D 61 9E FF D173 16 81 B5 CC 5B 67 D5 AF 12 4A DE 4D 8F 73 62C7 5D 3C C4 46 4E 33 1C 5E AB C5 8B 7C 9F A7 8237 95 C2 39 A4 2F 0C EE 7D 3A C9 14 8F 06 8C D85B 95 35 71 FB F8 A7 5A CE 51 10 A6 D7 D8 CA 7006 A2 0C D7 39 03 3B CA D6 C4 54 FE BB 8B 46 BB71 C8 4F 77 A3 BD 1E DE 30 02 C7 2D 02 BD B5 D7CB 97 AF D3 CF 2D 1E BA 1B F7 F0 4C 01 F4 3C 49A1 8E 6D E7 C8 29 49 4B 8D 16 06 52 88 12 74 3AF7 2B 7F 27 7C 8E 0F AF F4 86 85 6C ED EF 5E E8D4 41 A4 7C 4C 51 B2 A8 36 69 5B 60 7A 7A D7 C1AD 35 09 1E E6 14 8E 37 A4 03 51 12 41 F1 25 F858 A2 C1 80 C3 24 F9 A1 06 7D 67 C8 96 A0 C2 C20C 58 C5 D7 E5 83 1E 8B 6E EF 1F 4B 54 60 58 E42B 42 3D 55 A2 16 05 A7 F4 02 99 AE 66 42 00 B7FC B9 DF 57 6F 71 47 3B DE A0 87 2D 86 16 00 F1&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">c1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c1</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="s1">&#39;570845343bee39c510f3b2b7a1c95617aa6c7001854525b74c5e160eb51a2576ec857f680e64a5d6e417d2aaa2adc1387c11ec74616a5eb983c7fb554debbeed5dd7e0b8327f280fee1e66f3fc4c208e9cf6d6d43b&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ†æé¢˜ç›®å…³é”®éƒ¨åˆ†ï¼Œç›¸å…³æ•°å€¼åœ¨åé¢è¿›è¡Œäº†æ ‡æ³¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">p_bits</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="c1"># 1024</span>
</span></span><span class="line"><span class="cl"><span class="n">high_bit_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p_bits</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 682</span>
</span></span><span class="line"><span class="cl"><span class="n">p_high</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">p_bits</span> <span class="o">-</span> <span class="n">high_bit_count</span><span class="p">)</span>  <span class="c1"># 342</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">high_bit_count</span> <span class="o">-</span> <span class="s1">&#39;?&#39;</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">p_high_masked</span> <span class="o">=</span> <span class="n">p_high</span> <span class="o">&amp;</span> <span class="n">mask</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µä»£ç çš„æ‰§è¡Œçš„æ“ä½œæ˜¯å…ˆæŠŠpå³ç§»342ä½ï¼Œè¿™æ ·ä½342ä½çš„ä¿¡æ¯å°±å¤±å»äº†ï¼›ç„¶åå’Œmaskåšä¸€ä¸ªä¸çš„æ“ä½œ<br>
high_bit_count - &lsquo;?&rsquo; çš„ç»“æœä¸€å®šæ˜¯å°äºç­‰äº682çš„ï¼Œä¹Ÿå°±æ˜¯è¯´maskæ˜¯ä¸€ä¸ªå°äºç­‰äº682çš„å…¨1äºŒè¿›åˆ¶æ•°<br>
æœ€ç»ˆå¾—åˆ°çš„p_high_maskedå°±åˆä¼šå¤±å»é«˜ä½çš„ä¸€äº›ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆæˆ‘ä»¬å¾—åˆ°çš„æ˜¯pçš„ä¸­é—´çš„ä¸€éƒ¨åˆ†å†…å®¹<br>
æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ç°åœ¨å·²çŸ¥çš„pæœ‰å¤šå°‘ä½<code>len1 = len(bin(int(p, 16))[2:])</code>è¾“å‡º679ï¼Œè¿™æ„å‘³ç€åœ¨ä¸maskä¸è¿ç®—æ—¶ï¼Œä¸¢å¤±äº†æœ€é«˜çš„3ä½ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æšä¸¾è¿™3ä½(æ³¨æ„ä¸å¿…ä»0å¼€å§‹æšä¸¾ï¼Œå› ä¸ºä¸€å®šæœ‰3ä½ï¼Œæ‰€ä»¥ä»100å¼€å§‹111ç»“æŸ)ï¼Œç„¶åé€šè¿‡Copper Smithæ–¹æ³•æ¢å¤pçš„å…¶ä½™ä½ä½<br>
å‰©ä½™éƒ¨åˆ†exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sage" data-lang="sage"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">    <span class="n">p1</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">16</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">    <span class="n">p1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="n">n</span><span class="p">)[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span> <span class="o">&lt;&lt;</span> <span class="mi">342</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">    <span class="n">roots</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">small_roots</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">342</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">roots</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">roots</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span> <span class="o">&lt;&lt;</span> <span class="mi">342</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">c1</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">n</span><span class="p">)</span> <span class="c1"># è«åå…¶å¦™éœ€è¦int(d)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{wh3n_th3_m0dul3_i3_bi9_en0ugh_U_c@n_c0ns1der_u3ing_coppersmith}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="week4">Week4
</h2><h3 id="éšæœºæ•°ä¹‹æ—…4">éšæœºæ•°ä¹‹æ—…4
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">getPrime</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">bytes_to_long</span> <span class="k">as</span> <span class="n">b2l</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">uuid</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="n">getPrime</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="o">=</span><span class="s2">&#34;flag{&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span><span class="o">+</span><span class="s2">&#34;}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">pieces</span><span class="o">=</span><span class="p">[</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">flag</span><span class="p">),</span><span class="mi">3</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="n">b2l</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pieces</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">14</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">%</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">28</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">3028255493
</span></span></span><span class="line"><span class="cl"><span class="s2">[2981540507, 1806477191, 1912594455, 2801509477, 401085215, 818458584, 2397034605, 2120401989, 2008340439, 66147874, 1558789534, 2187085801, 671267991, 2930313508, 924435370, 902711250, 1226810076, 769329795, 2328739529, 1228810265, 1382003520, 1967489557, 2811050420, 1008248532, 1643249997, 639108823, 449982542, 1325050025]
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”±flagçš„æ ¼å¼å¯çŸ¥flagé•¿åº¦ä¸º42ï¼Œæ•…pieceså’Œcçš„é•¿åº¦å‡ä¸º14ï¼Œä¸xä¸€è‡´<br >
å…³é”®åœ¨äº<code>s=sum(c[i]*x[-14+i] for i in range(14))</code>æ˜¯æ‹¿xåˆ—è¡¨çš„å14ä¸ªå…ƒç´ ä¸cåˆ—è¡¨åšäº†ä¸€ä¸ªå†…ç§¯~~(è¿™ä¸ªè¯´æ³•åº”è¯¥æ˜¯å¯¹çš„å§)~~ç„¶åæ¨¡pè¿½åŠ åˆ°xåˆ—è¡¨æœ«å°¾ï¼Œæœ€åç»™å‡ºäº†xçš„æœ«å°¾28ä¸ªå…ƒç´ <br >
æˆ‘ä»¬æŠŠè¿™ä¸ªè¿‡ç¨‹ä»¥çŸ©é˜µçš„å½¢å¼ç»™å‡ºï¼Œæœ€å·¦è¾¹æ˜¯ä¸€ä¸ª14é˜¶æ–¹é˜µï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å…¶é€†çŸ©é˜µï¼Œä»è€Œæ¢å¤cå‘é‡<br >
æ³¨æ„åˆ°cå‘é‡ä¸­çš„æ¯ä¸€ä¸ªåˆ†é‡éƒ½æ˜¯å°äºpçš„(ä»å…¶æ„é€ å½¢å¼å¯ä»¥çœ‹å‡º)ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¿½ç•¥æ¨¡p
</p>
$$
\begin{pmatrix}
x_0 & x_1 & x_2 & \cdots & x_{13} \\
x_1 & x_2 & x_3 & \cdots & x_{14} \\
x_2 & x_3 & x_4 & \cdots & x_{15} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
x_{13} & x_{14} & x_{15} & \cdots & x_{26}
\end{pmatrix}
\times
\begin{pmatrix}
c_0 \\ c_1 \\ c_2 \\ \vdots \\ c_{13}
\end{pmatrix}
\equiv
\begin{pmatrix}
x_{14} \\ x_{15} \\ x_{16} \\ \vdots \\ x_{27}
\end{pmatrix}
\pmod{p}
$$<p>
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="mi">3028255493</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2981540507</span><span class="p">,</span> <span class="mi">1806477191</span><span class="p">,</span> <span class="mi">1912594455</span><span class="p">,</span> <span class="mi">2801509477</span><span class="p">,</span> <span class="mi">401085215</span><span class="p">,</span> <span class="mi">818458584</span><span class="p">,</span><span class="mi">2397034605</span><span class="p">,</span> <span class="mi">2120401989</span><span class="p">,</span> <span class="mi">2008340439</span><span class="p">,</span> <span class="mi">66147874</span><span class="p">,</span> <span class="mi">1558789534</span><span class="p">,</span> <span class="mi">2187085801</span><span class="p">,</span><span class="mi">671267991</span><span class="p">,</span> <span class="mi">2930313508</span><span class="p">,</span> <span class="mi">924435370</span><span class="p">,</span> <span class="mi">902711250</span><span class="p">,</span> <span class="mi">1226810076</span><span class="p">,</span> <span class="mi">769329795</span><span class="p">,</span><span class="mi">2328739529</span><span class="p">,</span> <span class="mi">1228810265</span><span class="p">,</span> <span class="mi">1382003520</span><span class="p">,</span> <span class="mi">1967489557</span><span class="p">,</span> <span class="mi">2811050420</span><span class="p">,</span> <span class="mi">1008248532</span><span class="p">,</span> <span class="mi">1643249997</span><span class="p">,</span> <span class="mi">639108823</span><span class="p">,</span> <span class="mi">449982542</span><span class="p">,</span> <span class="mi">1325050025</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">a</span><span class="p">[</span><span class="mi">14</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl"><span class="n">A_inv</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">A_inv</span> <span class="o">*</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{188a9250-bd02-4746-8ddd-a32d9c1bb11a}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸æ±‚é€†çŸ©é˜µï¼Œç”¨è§£æ–¹ç¨‹ç»„çš„æ–¹æ³•ä¹Ÿå¯ä»¥çš„</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">x1</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç‹¬ä¸€æ— äºŒ">ç‹¬ä¸€æ— äºŒ
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Sage 9.3</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">bytes_to_long</span> <span class="k">as</span> <span class="n">b2l</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">prevprime</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">uuid</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">D</span><span class="o">=</span><span class="n">b2l</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;flag</span><span class="se">{{</span><span class="si">{</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="si">}</span><span class="se">}}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span><span class="o">=</span><span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">AES</span><span class="o">.</span><span class="n">MODE_ECB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ct</span><span class="o">=</span><span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">pad</span><span class="p">(</span><span class="n">flag</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span><span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ct=&#34;</span><span class="p">,</span><span class="n">ct</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mes1</span><span class="o">=</span><span class="sa">b</span><span class="s2">&#34;If you used the same random number when signing,&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">mes2</span><span class="o">=</span><span class="sa">b</span><span class="s2">&#34; then you need to be careful.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">b2l</span><span class="p">(</span><span class="n">mes1</span><span class="p">),</span> <span class="n">b2l</span><span class="p">(</span><span class="n">mes2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="n">random_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">128</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">p</span><span class="p">),[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">G</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="n">prevprime</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">order</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;n=&#34;</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">k</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Q</span><span class="o">=</span><span class="n">k</span><span class="o">*</span><span class="n">G</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">%</span><span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="n">k_inv</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">assert</span> <span class="n">r</span><span class="o">!=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">k_inv</span> <span class="o">*</span> <span class="p">(</span><span class="n">e1</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">D</span><span class="p">))</span> <span class="o">%</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">k_inv</span> <span class="o">*</span> <span class="p">(</span><span class="n">e2</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">D</span><span class="p">))</span> <span class="o">%</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(r1,s1)=&#34;</span><span class="p">,(</span><span class="n">r</span><span class="p">,</span><span class="n">s1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(r2,s2)=&#34;</span><span class="p">,(</span><span class="n">r</span><span class="p">,</span><span class="n">s2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">ct= b&#39;</span><span class="se">\xd1\x7f</span><span class="s2">R</span><span class="se">\xda</span><span class="s2">z</span><span class="se">\x9c</span><span class="s2">T</span><span class="se">\xb8</span><span class="s2">{</span><span class="se">\x1b\t</span><span class="s2">s</span><span class="se">\xbc</span><span class="s2">J6#</span><span class="se">\x16</span><span class="s2">n</span><span class="se">\xce</span><span class="s2">dm</span><span class="se">\xd6</span><span class="s2">v)</span><span class="se">\x05</span><span class="s2">A3</span><span class="se">\x87\xc5</span><span class="s2">1</span><span class="se">\xfc\x9d</span><span class="s2">#</span><span class="se">\xe5\xf2</span><span class="s2">I@</span><span class="se">\x91\xc3\x96</span><span class="s2">w</span><span class="se">\xae</span><span class="s2">]</span><span class="se">\xc3</span><span class="s2">Uf</span><span class="se">\xd1\xee</span><span class="s2">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s2">n= 278302096557935581738338462024559946959
</span></span></span><span class="line"><span class="cl"><span class="s2">(r1,s1)= (264579573280920819291511588977260661069, 157195048165685698821267525173525379816)
</span></span></span><span class="line"><span class="cl"><span class="s2">(r2,s2)= (264579573280920819291511588977260661069, 61286613457098845815723227657607632607)
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ˜¯ä¸€é“å’Œæ¤­åœ†æ›²çº¿æœ‰å…³çš„é¢˜ç›®<code>E = EllipticCurve(Zmod(p),[A, B])</code>æ˜¯åœ¨æ„é€ æ¤­åœ†æ›²çº¿ï¼Œä½†è§£é¢˜å¹¶ä¸è¦æ±‚æˆ‘ä»¬æŒæ¡å¾ˆå¤šè¿™æ–¹é¢çš„çŸ¥è¯†<br >
çªç ´ç‚¹åœ¨äºå¯¹mes1å’Œmes2ä¸¤æ¡æ¶ˆæ¯ç­¾åæ—¶ï¼Œç”¨çš„rå’Œkéƒ½æ—¶ä¸€æ ·çš„ï¼Œæˆ‘ä»¬æ¨å¯¼ä¸€ä¸‹ï¼Œç›®æ ‡æ˜¯æ¢å¤å‡ºD
</p>
$$
\begin{cases}
s_1 \equiv k_{\text{inv}} \cdot (e_1 + r \cdot D) \mod n \\
s_2 \equiv k_{\text{inv}} \cdot (e_2 + r \cdot D) \mod n
\end{cases} \\
=>
\begin{cases}
k \equiv s_{1\text{inv}} \cdot (e_1 + r \cdot D) \mod n \\
k \equiv s_{2\text{inv}} \cdot (e_2 + r \cdot D) \mod n
\end{cases} \\
=>
s_{1\text{inv}} \cdot (e_1 + r \cdot D) \equiv s_{2\text{inv}} \cdot (e_2 + r \cdot D) \mod n \\
=>
s_{1\text{inv}} \cdot e_1 - s_{2\text{inv}} \cdot e_2 \equiv D \cdot (s_{2\text{inv}} \cdot r - s_{1\text{inv}} \cdot r)  \mod n
$$<p>
å¥½çš„ï¼Œåˆ°è¿™é‡Œåªéœ€è¦ä¸¤è¾¹åŒä¹˜ä¸€ä¸ªæ¨¡é€†å°±æ¢å¤å‡ºDäº†ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒDå°äºnå—ï¼Ÿåªæœ‰å°äºæ‰èƒ½ç›´æ¥æ‹¿åˆ°D
è¿™ä¸ªé—®é¢˜å…ˆæ”¾ä¸€æ”¾æœ€åçœ‹ï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆè¯•è¯•è¡Œä¸è¡Œ(æ˜¯å¯ä»¥çš„)</p>
<p>exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">bytes_to_long</span> <span class="k">as</span> <span class="n">b2l</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">unpad</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mes1</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;If you used the same random number when signing,&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">mes2</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34; then you need to be careful.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">b2l</span><span class="p">(</span><span class="n">mes1</span><span class="p">),</span> <span class="n">b2l</span><span class="p">(</span><span class="n">mes2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ct</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\xd1\x7f</span><span class="s1">R</span><span class="se">\xda</span><span class="s1">z</span><span class="se">\x9c</span><span class="s1">T</span><span class="se">\xb8</span><span class="s1">{</span><span class="se">\x1b\t</span><span class="s1">s</span><span class="se">\xbc</span><span class="s1">J6#</span><span class="se">\x16</span><span class="s1">n</span><span class="se">\xce</span><span class="s1">dm</span><span class="se">\xd6</span><span class="s1">v)</span><span class="se">\x05</span><span class="s1">A3</span><span class="se">\x87\xc5</span><span class="s1">1</span><span class="se">\xfc\x9d</span><span class="s1">#</span><span class="se">\xe5\xf2</span><span class="s1">I@</span><span class="se">\x91\xc3\x96</span><span class="s1">w</span><span class="se">\xae</span><span class="s1">]</span><span class="se">\xc3</span><span class="s1">Uf</span><span class="se">\xd1\xee</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">278302096557935581738338462024559946959</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">264579573280920819291511588977260661069</span><span class="p">,</span><span class="mi">157195048165685698821267525173525379816</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">264579573280920819291511588977260661069</span><span class="p">,</span><span class="mi">61286613457098845815723227657607632607</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">r1</span>
</span></span><span class="line"><span class="cl"><span class="n">s1_inv</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s2_inv</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1_inv</span> <span class="o">*</span> <span class="n">e1</span> <span class="o">-</span> <span class="n">s2_inv</span> <span class="o">*</span> <span class="n">e2</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="n">tmp1</span> <span class="o">=</span> <span class="p">(</span><span class="n">s2_inv</span> <span class="o">-</span> <span class="n">s1_inv</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span> <span class="o">%</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="n">D</span> <span class="o">=</span> <span class="n">tmp</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">tmp1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_ECB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">unpad</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>  <span class="c1"># ä¸å»å¡«å……ç›´æ¥æ‰“å°ä¹Ÿå¯ä»¥</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{035755ac-ba88-401d-93d3-d13607aa7387}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¥½çš„ï¼Œæˆ‘ä»¬å†çœ‹ä¸€çœ‹Dçš„å¤§å°çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å‡ºnçš„æ¯”ç‰¹é•¿æ˜¯128ä½çš„ï¼Œ<code>d=os.urandom(16);D=b2l(d)</code>ç”Ÿæˆ16å­—èŠ‚dï¼Œé‚£ä¹ˆDå°äºç­‰äº128ä½ï¼Œ128,127,126&hellip;éƒ½æœ‰å¯èƒ½ï¼Œåˆšæ‰æˆ‘ä»¬æ±‚å‡ºçš„Dæ˜¯125ä½çš„ï¼Œè€Œä¸”èƒ½æ±‚å‡ºflagï¼Œå¦‚æœD=D_0+k*n (D_0 &lt; n )çš„è¯ï¼Œè¿™é‡Œçš„kä¸ä¼šå¾ˆå¤§(æˆ–è®¸è¯´åªæœ‰0æˆ–1ä¸¤ç§å¯èƒ½)ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½è§£</p>
<h3 id="å…±è½­è¿·å®«">å…±è½­è¿·å®«
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">getcontext</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Quaternion</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">w</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">w1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
</span></span><span class="line"><span class="cl">        <span class="n">w2</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">z</span>
</span></span><span class="line"><span class="cl">        <span class="n">w</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">w2</span> <span class="o">-</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">z1</span> <span class="o">*</span> <span class="n">z2</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">w2</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">z2</span> <span class="o">-</span> <span class="n">z1</span> <span class="o">*</span> <span class="n">y2</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">z2</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">w2</span> <span class="o">+</span> <span class="n">z1</span> <span class="o">*</span> <span class="n">x2</span>
</span></span><span class="line"><span class="cl">        <span class="n">z</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">z2</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">z1</span> <span class="o">*</span> <span class="n">w2</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">Quaternion</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">norm_sq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">norm_sq</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;Cannot invert quaternion with zero norm&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">Quaternion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="n">norm_sq</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">/</span> <span class="n">norm_sq</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                          <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">norm_sq</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">/</span> <span class="n">norm_sq</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">Quaternion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">        <span class="n">w</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">z</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">norm_sq</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">w</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">z</span>
</span></span><span class="line"><span class="cl">        <span class="n">n</span> <span class="o">=</span> <span class="n">norm_sq</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">Quaternion</span><span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">y</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">z</span> <span class="o">/</span> <span class="n">n</span><span class="p">),</span> <span class="n">norm_sq</span><span class="p">,</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">i+</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">j+</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="si">}</span><span class="s2">k&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">w</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
</span></span><span class="line"><span class="cl">                <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
</span></span><span class="line"><span class="cl">                <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">generate_weak_private_key</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">angle_degrees</span><span class="o">=</span><span class="mi">45</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">g_vector_norm</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">g_vector_norm</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">Quaternion</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle_degrees</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">                          <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle_degrees</span><span class="p">)),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">u_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">g_vector_norm</span>
</span></span><span class="line"><span class="cl">    <span class="n">u_y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">g_vector_norm</span>
</span></span><span class="line"><span class="cl">    <span class="n">u_z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="n">g_vector_norm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">angle_rad</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">angle_degrees</span><span class="p">)</span> <span class="o">*</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">180</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">half_angle</span> <span class="o">=</span> <span class="n">angle_rad</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">w</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">half_angle</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="n">sin_half</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">half_angle</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">sin_half</span> <span class="o">*</span> <span class="n">u_x</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="o">=</span> <span class="n">sin_half</span> <span class="o">*</span> <span class="n">u_y</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="o">=</span> <span class="n">sin_half</span> <span class="o">*</span> <span class="n">u_z</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">Quaternion</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encode_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag_bytes</span> <span class="o">=</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl">    <span class="n">parts</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag_bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">],</span> <span class="n">flag_bytes</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">18</span><span class="p">],</span> <span class="n">flag_bytes</span><span class="p">[</span><span class="mi">18</span><span class="p">:</span><span class="mi">27</span><span class="p">],</span> <span class="n">flag_bytes</span><span class="p">[</span><span class="mi">27</span><span class="p">:</span><span class="mi">36</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;flag</span><span class="si">{REDACTED}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">encode_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#ç”Ÿæˆå…ƒg</span>
</span></span><span class="line"><span class="cl">    <span class="n">g</span> <span class="o">=</span> <span class="n">Quaternion</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(g)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;norm_squared=</span><span class="si">{</span><span class="n">g</span><span class="o">.</span><span class="n">norm</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">norm</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#Aliceçš„ç§é’¥a</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">=</span> <span class="n">generate_weak_private_key</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#Aliceçš„å…¬é’¥P_A</span>
</span></span><span class="line"><span class="cl">    <span class="n">P_A</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#Bobçš„ç§é’¥b</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">=</span> <span class="n">generate_weak_private_key</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#Bobçš„å…¬é’¥P_B</span>
</span></span><span class="line"><span class="cl">    <span class="n">P_B</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">#Aliceè®¡ç®—å‡ºçš„å…±äº«å¯†é’¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">K_Alice</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">P_B</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#Bobè®¡ç®—å‡ºçš„å…±äº«å¯†é’¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">K_Bob</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">P_A</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Aliceå’ŒBobçš„å…±äº«å¯†é’¥æ˜¯å¦ç›¸ç­‰: </span><span class="si">{</span><span class="n">K_Alice</span><span class="o">==</span><span class="n">K_Bob</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Aliceçš„å…±äº«å¯†é’¥: </span><span class="si">{</span><span class="n">K_Alice</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">norm_squared=15960922284361974605582033637987025644912788
</span></span></span><span class="line"><span class="cl"><span class="s1">Aliceå’ŒBobçš„å…±äº«å¯†é’¥æ˜¯å¦ç›¸ç­‰: True
</span></span></span><span class="line"><span class="cl"><span class="s1">Aliceçš„å…±äº«å¯†é’¥: 0.47292225874042030771896799291807799271678994351844+0.44018598307489329918958641928841974350737975182974i+0.54174915328248053441099670537355485876445440400706j+0.53766968708489053913141352127029842443636489064268k
</span></span></span><span class="line"><span class="cl"><span class="s1">åŒ–ä¸ºæ•´æ•°çš„flagçš„ç¬¬ä¸€éƒ¨åˆ†åå…­ä½åè¿›åˆ¶æ•°ä¸º271603ï¼Œç¬¬äºŒéƒ¨åˆ†åå…­ä½åè¿›åˆ¶æ•°ä¸º292847ï¼Œç¬¬ä¸‰éƒ¨åˆ†åå…­ä½åè¿›åˆ¶æ•°ä¸º939167ï¼Œç¬¬å››éƒ¨åˆ†åå…­ä½åè¿›åˆ¶æ•°ä¸º994109
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ˜¯ä¸€é“ç”¨å››å…ƒæ•°çš„å¯†é’¥äº¤æ¢åè®®çš„é¢˜ç›®ï¼Œé‡ç‚¹æ˜¯å››å…ƒæ•°ä¸€èˆ¬æƒ…å†µä¸‹çš„ä¹˜æ³•æ˜¯ä¸å¯äº¤æ¢çš„<br >
åˆ†æä¸»å‡½æ•°ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¦æ¢å¤gï¼Œç°æœ‰çš„æ˜¯gçš„èŒƒæ•°å’Œç»è¿‡å¯†é’¥äº¤æ¢åè®®è®¡ç®—åçš„ç›¸ç­‰çš„K_Aliceå’ŒK_Bobï¼Œä»¥åŠåŒ–ä¸ºæ•´æ•°çš„flagçš„å„éƒ¨åˆ†çš„åå…­ä½åè¿›åˆ¶æ•°(è¿™ä¸ªæš‚æ—¶ä¸çŸ¥é“æ€ä¹ˆç”¨ï¼Œå…ˆæ”¾ä¸€æ”¾)ï¼Œè°ƒç”¨g = g.norm()[0]å°†gè½¬åŒ–ä¸ºå•ä½å››å…ƒæ•°<br >
è‡ªç„¶åœ°ï¼Œæˆ‘ä»¬ä¸‹ä¸€æ­¥è¦çœ‹generate_weak_private_keyå‡½æ•°ï¼Œè‹¥g_vector_norm &lt; 1e-10ï¼Œåˆ™è¿”å›ä¸€ä¸ªåªå’Œè§’åº¦æœ‰å…³çš„å››å…ƒæ•°ï¼Œå¦åˆ™çš„è¯è¦å’Œgçš„åˆ†é‡è¿›è¡Œä¸€ç³»åˆ—è¿ç®—ã€‚æ¼”ç®—ä¸€ä¸‹ç”Ÿæˆç§é’¥aå’Œbçš„è¿‡ç¨‹ï¼Œg_vector_norm &lt; 1e-10åº”å½“æ˜¯ä¸æˆç«‹çš„ï¼Œå› ä¸ºgçš„å››ä¸ªåˆ†é‡w,x,y,zå¤§å°åº”è¯¥ç›¸å·®ä¸å¤§ï¼Œæˆ‘ä»¬å‘ç°ç”Ÿæˆçš„aå’Œbéƒ½æ˜¯å•ä½å››å…ƒæ•°ï¼Œä¸”å…·æœ‰æŸäº›ç›¸ä¼¼æ€§ï¼Œå¯¼è‡´aå’Œbçš„ä¹˜æ³•æ˜¯å¯äº¤æ¢çš„(å…·ä½“éªŒè¯è¿‡ç¨‹(æ— è„‘å±•å¼€)å°±ä¸æ”¾äº†)ï¼Œå¯ä»¥è¿›ä¸€æ­¥æ¨å‡ºa.inv()å’Œb.inv()çš„ä¹˜æ³•ä¹Ÿæ˜¯å¯äº¤æ¢çš„<br >
åˆ°è¿™é‡Œå°±å¡ä½äº†ï¼Œå› ä¸ºä¹‹å‰åšä¹˜æ³•çš„æ—¶å€™éƒ½ç›¸å½“äºåªæ˜¯åœ¨å±•å¼€å¤šé¡¹å¼ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸‰è§’å‡½æ•°å½¢å¼ä¸‹çš„å››å…ƒæ•°ä¹˜æ³•
</p>
$$
q = \cos\left(\frac{\theta}{2}\right) + u \sin\left(\frac{\theta}{2}\right)
$$<p>
ä¸éš¾å‘ç°ï¼Œå¯¹äºaå’Œbå’Œgï¼Œuå‘é‡æ˜¯ç›¸åŒçš„ï¼Œå…¶ä¸­Î¸æ˜¯æ—‹è½¬è§’åº¦ï¼Œuæ»¡è¶³ $\|u\| = \sqrt{u_x^2 + u_y^2 + u_z^2} = 1$ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç»“è®ºï¼Œå¦‚æœä¸¤ä¸ªå››å…ƒæ•°æœ‰ç›¸åŒçš„æ—‹è½¬è½´ï¼Œä»–ä»¬çš„ä¹˜ç§¯å¯è¡¨ç¤ºä¸º(ç±»ä¼¼äºå¤æ•°ä¹˜æ³•çš„æ€§è´¨ï¼šè§’åº¦ç›¸åŠ )
</p>
$$
q_1 q_2 = \cos\left(\frac{\theta_1 + \theta_2}{2}\right) + u \sin\left(\frac{\theta_1 + \theta_2}{2}\right)
$$<p>
<del>æ²¡æœ‰å…·ä½“æ¨å¯¼éªŒè¯ï¼Œæœ‰æœºä¼šè¯•ä¸€ä¸‹</del>  ä»è¿™é‡Œä¹Ÿèƒ½æ›´æ¸…æ¥šçš„çœ‹å‡ºaå’Œbä¹˜æ³•æ˜¯å¯äº¤æ¢çš„<br >
å¦å¤–ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œa * g * aâ»Â¹ç§°ä¸ºå››å…ƒæ•°å…±è½­ä½œç”¨ï¼Œç‰¹æ®Šåœ°ï¼Œå¦‚æœå•ä½å››å…ƒæ•°açš„æ—‹è½¬è½´ä¸gçš„å‘é‡éƒ¨åˆ†æ–¹å‘ç›¸åŒï¼ˆå¹³è¡Œï¼‰ï¼Œé‚£ä¹ˆï¼ša * g * aâ»Â¹ = gï¼Œé‚£ä¹ˆç”±äºvector_norm &gt;1e-10ï¼ŒK = (ab) * g * (ab)â»Â¹ = g<br >
é‚£ä¹ˆå°±å¯ä»¥å†™ä¸€ä¸ªç®€å•çš„exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">norm_squared</span> <span class="o">=</span> <span class="mi">15960922284361974605582033637987025644912788</span>
</span></span><span class="line"><span class="cl"><span class="n">w</span> <span class="o">=</span> <span class="mf">0.47292225874042030771896799291807799271678994351844</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="mf">0.44018598307489329918958641928841974350737975182974</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="mf">0.54174915328248053441099670537355485876445440400706</span>
</span></span><span class="line"><span class="cl"><span class="n">z</span> <span class="o">=</span> <span class="mf">0.53766968708489053913141352127029842443636489064268</span>
</span></span><span class="line"><span class="cl"><span class="n">norm</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">norm_squared</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">w0</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">norm</span> <span class="o">*</span> <span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x0</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">norm</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">y0</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">norm</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">z0</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">norm</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">w0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">y0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">z0</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‘ç°è¾“å‡ºæ˜¯è¿™æ ·çš„ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½ç¼ºä¸¤ä¸ªå­—èŠ‚ï¼Œè¿™æ˜¯ç”±äºåœ¨è®¡ç®—ä¸­æŸå¤±äº†ä¸€äº›ç²¾åº¦ï¼Œè¿™ä¹Ÿå°±æ˜¯åŒ–ä¸ºæ•´æ•°çš„flagçš„å„éƒ¨åˆ†çš„åå…­ä½åè¿›åˆ¶æ•°çš„ä½œç”¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">b&#39;flag{hd\x00\x00&#39;
</span></span><span class="line"><span class="cl">b&#39;_U_f1nd\x00\x00&#39;
</span></span><span class="line"><span class="cl">b&#39;uT_@bot\x00\x00&#39;
</span></span><span class="line"><span class="cl">b&#39;tr1ck?T\x00\x00&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¨åŠ ä¿®æ”¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">flag1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">271603</span><span class="p">,</span> <span class="mi">292847</span><span class="p">,</span> <span class="mi">939167</span><span class="p">,</span> <span class="mi">994109</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">w0</span> <span class="o">-</span> <span class="n">w0</span> <span class="o">%</span> <span class="mi">1000000</span> <span class="o">+</span> <span class="n">flag1</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">x0</span> <span class="o">%</span> <span class="mi">1000000</span> <span class="o">+</span> <span class="n">flag1</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">y0</span> <span class="o">-</span> <span class="n">y0</span> <span class="o">%</span> <span class="mi">1000000</span> <span class="o">+</span> <span class="n">flag1</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">z0</span> <span class="o">-</span> <span class="n">z0</span> <span class="o">%</span> <span class="mi">1000000</span> <span class="o">+</span> <span class="n">flag1</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{hav3_U_f1nd_ouT_@bout_tr1ck?XD}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸ªäººæ„Ÿè§‰å¦‚æœä¸æ‡‚å››å…ƒæ•°ç¡®å®ä¸å¥½åšï¼Œé€šè¿‡è¿™ä¸ªé¢˜äº†è§£åˆ°ä¸€äº›çš®æ¯›ï¼Œè¿˜å¾—å†ä»”ç»†ç ”ç©¶ç ”ç©¶&hellip;</p>
<h3 id="å¤©è™«çš„ç§˜å¯†">å¤©è™«çš„ç§˜å¯†
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span><span class="p">,</span><span class="n">unpad</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">FLAG</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">KEY</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">iv1</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span><span class="o">=</span><span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span><span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span><span class="n">iv</span><span class="o">=</span><span class="n">iv1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ct</span><span class="o">=</span><span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">pad</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">iv1</span><span class="o">+</span><span class="n">ct</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">oracle</span><span class="p">(</span><span class="n">data_b64</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">data_b64</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">32</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="sa">b</span><span class="s1">&#39;ERR1</span><span class="se">\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">iv</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">ct</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">16</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">pt</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">unpad</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="sa">b</span><span class="s1">&#39;OK</span><span class="se">\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="sa">b</span><span class="s1">&#39;ERR2</span><span class="se">\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="sa">b</span><span class="s1">&#39;ERR3</span><span class="se">\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">tries</span><span class="o">=</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;Enter what you want to try, format: base64(iv+ct)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">tries</span><span class="o">==</span><span class="s2">&#34;q&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">oracle</span><span class="p">(</span><span class="n">tries</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å’ŒAESçš„å¡«å……æœ‰å…³çš„ä¸€é“é¢˜ç›®ï¼ŒæŸ¥äº†æŸ¥ï¼Œå‘ç°æ˜¯ä¸€ä¸ªå«Padding oracleçš„æ”»å‡»æ‰‹æ³•ï¼Œ<a href='# https://goodapple.top/archives/217'>å‚è€ƒåšå®¢</a>ï¼Œé‡Œé¢çš„åŸç†è®²çš„å¾ˆæ¸…æ¥šï¼Œçœ‹å®Œå°±æ‡‚è¿™é“é¢˜åº”è¯¥æ€ä¹ˆåšäº†ï¼Œæ ¸å¿ƒå°±æ˜¯åˆ©ç”¨æœåŠ¡å™¨çš„åé¦ˆï¼Œä½¿å¾—æˆ‘ä»¬çŸ¥é“å»å¡«å……æ˜¯å¦æˆåŠŸï¼Œå»é€å­—èŠ‚çˆ†ç ´aesè§£å¯†åçš„ä¸­é—´å€¼(ä¸æ˜¯æ˜æ–‡)ï¼Œè¿›ä¸€æ­¥æ¢å¤æ˜æ–‡  <del>æç„¶å¤§æ‚Ÿï¼Œå¤©è™«æŒ‡çš„æ˜¯å¡«å……</del><br>
ä¸‹é¢æ˜¯å®ç°çš„ä¸€ä¸ªexpï¼Œæœ€åçš„è¾“å‡ºæœ‰ç‚¹å¤šï¼Œå¯ä»¥æŠŠ39è¡Œçš„print(res)æ³¨é‡Šæ‰ï¼Œæ›´ç®€æ´<br>
ä¸å¾—ä¸æçš„æ˜¯ï¼Œæˆ‘åœ¨å¾ªç¯è°ƒç”¨padding_oracle_attackæ—¶ï¼Œæ¯æ¬¡éƒ½ä¼šå»é‡æ–°è¿ä¸€æ¬¡è¿œç¨‹ï¼Œå¦‚æœæœåŠ¡å™¨ç«¯flagæ˜¯åŠ¨æ€çš„ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå‡ºé—®é¢˜ï¼Œå¹¸è¿çš„æ˜¯è¿™ä¸ªé¢˜flagæ˜¯å›ºå®šçš„ï¼Œæˆ‘æƒ³å»æ”¹è¿™ä¸ªç‚¹ï¼Œä¸€æ–¹é¢ç”±äºpwntoolsä½¿ç”¨ä¸ç†Ÿç»ƒï¼Œå¦ä¸€æ–¹é¢ä¸€æ”¹å°±æœ‰bugï¼Œå®åœ¨æ”¹ä¸åŠ¨äº†ï¼Œé‚æ”¾å¼ƒäº†ï¼Œå°±ä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬äº†(</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">mid_m</span><span class="p">,</span> <span class="n">tmp_i</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mid_m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp_i</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">mid_m</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">^</span> <span class="n">tmp</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">tmp_i</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">padding_oracle_attack</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;8.147.132.32&#39;</span><span class="p">,</span> <span class="mi">17242</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">line1</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">data_b64</span> <span class="o">=</span> <span class="n">line1</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Base64 data: </span><span class="si">{</span><span class="n">data_b64</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;base64(iv+ct)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">original_data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">data_b64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">iv</span> <span class="o">=</span> <span class="n">original_data</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">ct_blocks</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="n">original_data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_data</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;IV: </span><span class="si">{</span><span class="n">iv</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;CT blocks: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ct_blocks</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">ct_blocks</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">c_tmp</span> <span class="o">=</span> <span class="n">ct_blocks</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> 
</span></span><span class="line"><span class="cl">    <span class="n">test_iv</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">mid_m</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp_i</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">255</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">test_iv</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">            <span class="n">send</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">test_iv</span><span class="p">)</span> <span class="o">+</span> <span class="n">c_tmp</span>
</span></span><span class="line"><span class="cl">            <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">send</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="sa">b</span><span class="s1">&#39;OK&#39;</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">tmp_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">i</span> <span class="o">^</span> <span class="p">(</span><span class="mi">16</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid_m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp_i</span> <span class="o">=</span> <span class="n">func1</span><span class="p">(</span><span class="n">mid_m</span><span class="p">,</span> <span class="n">tmp_i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp_i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tmp1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">test_iv</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_i</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">mid_m</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span> <span class="o">=</span> <span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid_m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">iv</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span> <span class="o">=</span> <span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="n">mid_m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">ct_blocks</span><span class="p">[</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ans</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">padding_oracle_attack</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{92a347e1-e485-40e6-b96d-b8d9cfbf14fe}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä¸‰é‡å¯†é’¥é”">ä¸‰é‡å¯†é’¥é”
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encode_flag_to_abc</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">flag_bytes</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">third</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag_bytes</span><span class="p">)</span> <span class="o">//</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="n">a_bytes</span> <span class="o">=</span> <span class="n">flag_bytes</span><span class="p">[:</span><span class="n">third</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">b_bytes</span> <span class="o">=</span> <span class="n">flag_bytes</span><span class="p">[</span><span class="n">third</span><span class="p">:</span><span class="mi">2</span> <span class="o">*</span> <span class="n">third</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">c_bytes</span> <span class="o">=</span> <span class="n">flag_bytes</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">third</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">a_bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">b_bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">c_bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">random_prime</span><span class="p">(</span><span class="mi">2</span> <span class="o">^</span> <span class="mi">512</span><span class="p">,</span> <span class="n">lbound</span><span class="o">=</span><span class="mi">2</span> <span class="o">^</span> <span class="mi">511</span><span class="p">)</span>  <span class="c1"># 512ä½ç´ æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">bitsize</span> <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">encode_flag_to_abc</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">assert</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">^</span> <span class="n">bitsize</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">^</span> <span class="n">bitsize</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">^</span> <span class="n">bitsize</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">k</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="n">b</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;=== ä¸‰é‡å¯†é’¥é”ï¼ˆæ ‡é‡ç‰ˆï¼‰===&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ¨¡æ•° p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ç³»æ•° k = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ç³»æ•° m = </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ç³»æ•° n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;éªŒè¯å€¼ f = </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æç¤º: a,b,céƒ½æ˜¯å¤§çº¦</span><span class="si">{</span><span class="n">bitsize</span><span class="si">}</span><span class="s2">æ¯”ç‰¹çš„æ•´æ•°&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">=== ä¸‰é‡å¯†é’¥é”ï¼ˆæ ‡é‡ç‰ˆï¼‰===
</span></span></span><span class="line"><span class="cl"><span class="s1">æ¨¡æ•° p = 10424356578148041779853991789187969944186570125402901113699573185144158488847151089093649435805832723680640302469301322004769382556869280204369016044400623
</span></span></span><span class="line"><span class="cl"><span class="s1">ç³»æ•° k = 2016425917343526209264752974016973527106088400191647819396444997081866888816818440804306653900752825844532111319244334210470353279795203950886189568717273
</span></span></span><span class="line"><span class="cl"><span class="s1">ç³»æ•° m = 9640575609666038466312358795458735166723157003124018050805657432015561577987823522956739610343817276374800232163184447140344754253531140765054930193240661
</span></span></span><span class="line"><span class="cl"><span class="s1">ç³»æ•° n = 8539207304708818916453730202381072788689351891251165656488809155919585187699733568697903825636944248694317545906020707873051567183468920809837554174735591
</span></span></span><span class="line"><span class="cl"><span class="s1">éªŒè¯å€¼ f = 3760813688323379339493776734416231127517302841171887658445242754803946122769018586447782634756726656702581791734772105099204609201876825961922712387326893
</span></span></span><span class="line"><span class="cl"><span class="s1">æç¤º: a,b,céƒ½æ˜¯å¤§çº¦128æ¯”ç‰¹çš„æ•´æ•°
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é¢˜ç›®åœ¨åå¤æç¤ºa,b,céƒ½æ˜¯å¤§çº¦128æ¯”ç‰¹çš„æ•´æ•°ï¼Œç›¸è¾ƒäºp,k&hellip;è¿™äº›æ•°æ˜¯è¾ƒå°çš„ï¼Œè¿™éƒ½åœ¨è¯´æ˜è¦ç”¨æ ¼çš„LLLç®—æ³•è§£è¿™é“é¢˜<br >
æˆ‘ä»¬æœ‰çš„æ˜¯<code>f = (k * a + m * b + n * c) % p</code>æ”¹å†™æˆç­‰å¼å½¢å¼
</p>
$$
f = k \cdot a + m \cdot b + n \cdot c - t \cdot p
$$<p>
ä¸€å¼€å§‹æˆ‘æ„é€ çš„æ˜¯è¿™æ ·çš„
</p>
$$
(a, b, c, -t) \times
\begin{pmatrix}
1 & 0 & 0 & k \\
0 & 1 & 0 & m \\
0 & 0 & 1 & n \\
0 & 0 & 0 & p
\end{pmatrix}
= (a, b, c, f)
$$<p>
åœ¨è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„å®šç†ï¼Œ<del>åå­—å’Œå…·ä½“å½¢å¼éƒ½å¿˜è®°äº†</del>ï¼Œå†…å®¹å°±æ˜¯ä¸€ä¸ªæ ¼çŸ©é˜µLä¸€å®šæœ‰ä¸€ä¸ªå°å‘é‡ï¼Œæ»¡è¶³èŒƒæ•°(å³å„åˆ†é‡å¹³æ–¹å’Œå†å¼€æ ¹å·)å°äºç­‰äº$\sqrt{n} \cdot \det(L)^{1/n}$ï¼Œå…¶ä¸­nä¸ºLä¸­åŸºå‘é‡çš„ä¸ªæ•°ï¼Œåœ¨è¿™é‡Œn=4ï¼Œå¦‚æœæˆ‘ä»¬çš„ç›®æ ‡å‘é‡ï¼Œä¹Ÿå°±æ˜¯ç­‰å·å³è¾¹çš„å‘é‡å®ƒçš„èŒƒæ•°æ¯”è¿™ä¸ªç•Œé™å¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯è§„çº¦ä¸å‡ºæ¥çš„<br>
æˆ‘ä»¬ä»£å…¥å„ä¸ªæ•°æ®çš„æ¯”ç‰¹ä½æ•°ç²—ç•¥éªŒè¯åå‘ç°ä¸è¡Œï¼Œä¸»è¦åŸå› å°±æ˜¯få¤ªå¤§ï¼Œæ‰€ä»¥é‡æ–°æ„é€ ï¼Œå³è¾¹ä¸èƒ½å‡ºç°f
</p>
$$
k \cdot a + m \cdot b + n \cdot c - t \cdot p - f =0 \\
(a, b, c, -t, -1) \times
\begin{pmatrix}
1 & 0 & 0 & 0 & k \\
0 & 1 & 0 & 0 & m \\
0 & 0 & 1 & 0 & n \\
0 & 0 & 0 & 1 & p \\
0 & 0 & 0 & 0 & f
\end{pmatrix}
= (a, b, c, -t, 0)
$$<p>
ç°åœ¨åªéœ€è¦è€ƒå¯Ÿä¸€ä¸‹tçš„å¤§å°å°±å¥½äº†$f = k \cdot a + m \cdot b + n \cdot c - t \cdot p$ç”±è¿™ä¸ªå¼å­å„ä¸ªæ•°å­—çš„æ¯”ç‰¹ä½ä¼°ç®—ï¼Œtçš„å¤§å°å’Œa,b,cç›¸å½“ï¼Œå¯è¡Œ<br >
æ¥ä¸‹æ¥éªŒè¯ä¸€ä¸‹ä¸Šé¢çš„å®šç†æ˜¯å¦æ»¡è¶³ï¼Œå³è¾¹å‘é‡çš„èŒƒæ•°å¤§æ¦‚128ä½ï¼Œå·¦è¾¹çš„è¡Œåˆ—å¼å¼€äº”æ¬¡æ–¹å¤§æ¦‚æ˜¯100ä½ï¼Œå‘ç°ä¸è¡Œï¼Œè¿™ç§æƒ…å†µå°±è¦è¿›è¡Œä¸€ä¸‹ç®€å•çš„é…æ–¹ï¼Œå…·ä½“åšæ³•æ˜¯ç»™LçŸ©é˜µæœ€åä¸€åˆ—éƒ½ä¹˜ä¸€ä¸ªæ•°ï¼Œè¿™æ ·ä½¿å¾—è¡Œåˆ—å¼å˜å¤§ï¼Œè€Œå³è¾¹å‘é‡ä¸å˜ï¼Œæˆ‘ä»¬è¿™é‡Œä¹˜2**150ï¼Œè§„çº¦å‡ºçš„æœ€åä¸€ä½æ˜¯0ï¼ŒæˆåŠŸ<br >
</p>
$$
\begin{pmatrix}
1 & 0 & 0 & 0 & 2^{150} \cdot k \\
0 & 1 & 0 & 0 & 2^{150} \cdot m \\
0 & 0 & 1 & 0 & 2^{150} \cdot n \\
0 & 0 & 0 & 1 & 2^{150} \cdot p \\
0 & 0 & 0 & 0 & 2^{150} \cdot f
\end{pmatrix}
$$<p>
åˆ°è¿™é‡Œå†çœ‹ä¸€çœ¼æœ€å¼€å§‹çš„å››é˜¶çŸ©é˜µä¸ºä»€ä¹ˆä¸è¡Œï¼Œå…¶ä¸€æ˜¯ä¸æ»¡è¶³å®šç†çš„ç•Œé™ï¼Œæ›´é‡è¦çš„æ˜¯æ²¡åŠæ³•é…å¹³ï¼Œæ”¹å˜çŸ©é˜µçš„è¡Œåˆ—å¼ï¼Œå³è¾¹çš„å‘é‡ä¹Ÿä¼šå˜åŒ–
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="mi">10424356578148041779853991789187969944186570125402901113699573185144158488847151089093649435805832723680640302469301322004769382556869280204369016044400623</span>
</span></span><span class="line"><span class="cl"><span class="n">k</span> <span class="o">=</span> <span class="mi">2016425917343526209264752974016973527106088400191647819396444997081866888816818440804306653900752825844532111319244334210470353279795203950886189568717273</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="mi">9640575609666038466312358795458735166723157003124018050805657432015561577987823522956739610343817276374800232163184447140344754253531140765054930193240661</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">8539207304708818916453730202381072788689351891251165656488809155919585187699733568697903825636944248694317545906020707873051567183468920809837554174735591</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="mi">3760813688323379339493776734416231127517302841171887658445242754803946122769018586447782634756726656702581791734772105099204609201876825961922712387326893</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">150</span> <span class="o">*</span> <span class="n">k</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">150</span> <span class="o">*</span> <span class="n">m</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">150</span> <span class="o">*</span> <span class="n">n</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">150</span> <span class="o">*</span> <span class="n">p</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">150</span> <span class="o">*</span> <span class="n">f</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c1"># ç”±äºå¯¹ç§°æ€§ï¼Œè¦å¸¦ä¸ªç»å¯¹å€¼è½¬æˆæ­£æ•°</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{op3n_A_d007_t0_th3_w0rld_0f_latt1ce}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="week5">Week5
</h2><h3 id="poly">Poly
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">b2l</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">b</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">byte</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">uuid</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">random_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">256</span><span class="p">)</span>  <span class="c1">#Sage 9.3</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;flag</span><span class="se">{{</span><span class="si">{</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="si">}</span><span class="se">}}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">x1</span> <span class="o">=</span> <span class="n">f</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">x2</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl"><span class="n">m1</span> <span class="o">=</span> <span class="n">b2l</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">m2</span> <span class="o">=</span> <span class="n">b2l</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="n">m1</span> <span class="o">^</span> <span class="mi">19</span> <span class="o">+</span> <span class="n">m1</span> <span class="o">^</span> <span class="mi">18</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">m1</span> <span class="o">^</span> <span class="mi">17</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">m2</span> <span class="o">^</span> <span class="mi">19</span> <span class="o">+</span> <span class="n">m2</span> <span class="o">^</span> <span class="mi">18</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">m2</span> <span class="o">^</span> <span class="mi">17</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">m1</span> <span class="o">^</span> <span class="mi">7</span> <span class="o">*</span> <span class="n">m2</span> <span class="o">^</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">m2</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">((</span><span class="n">p</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">(30784558756838163538710632027143185397437897603217673077150297305544071001199, 2909317260219356685336632301474678396728564531244632916913671591997406996972, 4294738619365099885640900866122577092111906369664055461700321556058254607968, 8215705534787817006092091346252328321484153279277254569529867991109185617083)
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªé¢˜æ„é€ äº†ä¸‰ä¸ªå¤šé¡¹å¼ï¼Œå…¶ä¸­c1æ˜¯å…³äºm1çš„ï¼Œc2æ˜¯å…³äºm2çš„ï¼Œè€Œsæ˜¯ä¸€ä¸ªäºŒå…ƒå¤šé¡¹å¼<br >
æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ±‚å‡ºm1å’Œm2ï¼Œä½†æ˜¯è¿™ä¸ªé¢˜æœ‰bugï¼Œåº”è¯¥æ˜¯æ•°æ®å¤ªå°çš„ç¼˜æ•…ï¼Œä¸ç”¨så¤šé¡¹å¼ï¼Œç›´æ¥æ±‚c1å’Œc2çš„æ ¹å°±èƒ½å‡ºç»“æœï¼Œä¹‹åçœ‹çœ‹é¢„æœŸè§£åº”è¯¥æ€ä¹ˆåšå§<br >
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">p</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30784558756838163538710632027143185397437897603217673077150297305544071001199</span><span class="p">,</span><span class="mi">2909317260219356685336632301474678396728564531244632916913671591997406996972</span><span class="p">,</span><span class="mi">4294738619365099885640900866122577092111906369664055461700321556058254607968</span><span class="p">,</span><span class="mi">8215705534787817006092091346252328321484153279277254569529867991109185617083</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">PR</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">f1</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">19</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">17</span><span class="o">-</span><span class="n">c1</span>
</span></span><span class="line"><span class="cl"><span class="n">f2</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">19</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">17</span><span class="o">-</span><span class="n">c2</span>
</span></span><span class="line"><span class="cl"><span class="n">roots1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">roots2</span> <span class="o">=</span> <span class="n">f2</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># è¿™ä¸ªå‚æ•°çš„æ„æ€æ˜¯ä¸è¦æ ¹çš„é‡æ•°ï¼Œæˆ‘ä»¬ç”¨ä¸ä¸Š</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">roots1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">roots2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{3bdb2424-591a-4a92-b587-74951c8ad192}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="smileç›’">Smileç›’
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">CathylinFour</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">deblock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[(</span><span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">,</span> <span class="n">m</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nibbles</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="n">nibbles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">nibbles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">nibbles</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">nibbles</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">permute_bits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">bits</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">15</span> <span class="o">-</span> <span class="n">i</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span>  
</span></span><span class="line"><span class="cl">        <span class="n">new_bits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">new_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">new_bits</span><span class="p">[</span><span class="n">new_pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">bits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">new_bits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">m</span> <span class="o">&amp;</span> <span class="mh">0xffff</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>  
</span></span><span class="line"><span class="cl">            <span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">^</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> 
</span></span><span class="line"><span class="cl">            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deblock</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permute_bits</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">^</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>  
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deblock</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span> <span class="o">=</span> <span class="n">p</span> <span class="o">^</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">c</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">FLAG</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0xffff</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">enc</span> <span class="o">=</span> <span class="n">CathylinFour</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Press a number to try. Press &#39;q&#39; to quit. Press &#39;k&#39; to get flag.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;Your input: &#34;</span><span class="p">)</span>  <span class="c1"># Tips: Your input should be 0x????</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Bye.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ki</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;Your key:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ki</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">key</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;You can smile:&#34;</span><span class="p">,</span> <span class="n">FLAG</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Wrong. Bye.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Output:&#34;</span><span class="p">,</span> <span class="nb">hex</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ˜¯ä¸€é“å¯¹Sç›’å·®åˆ†æ”»å‡»çš„é¢˜ç›®ï¼Œå‚è€ƒåšå®¢<a href='https://blog.nowcoder.net/n/80fd8f4a695f4f2f96fd94a3248fd9ee'>å·®åˆ†æ”»å‡»</a>ï¼ŒåŠ å¯†çš„ç»“æ„ç±»ä¼¼äºCIPHERFOURç»“æ„ï¼Œä¸è¿‡æ˜¯ç®€åŒ–ç‰ˆæœ¬çš„ï¼Œå› ä¸ºåªæœ‰3ä¸ªå¯†é’¥ï¼Œåªç»è¿‡äº†ä¸¤æ¬¡Sç›’ä»£æ¢ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ±‚å‡ºæœ€åä¸€ä¸ªå¯†é’¥<br >
æˆ‘ä»¬å…ˆæ±‚ä¸€ä¸‹é¢˜ç›®ä¸­çš„Sç›’çš„å·®åˆ†åˆ†å¸ƒè¡¨ï¼Œå¦‚ä¸‹ï¼Œæ¨ªåæ ‡ä¸ºè¾“å…¥å·®åˆ†(ä»ä¸Šåˆ°ä¸‹ï¼Œä»0åˆ°f)ï¼Œçºµåæ ‡ä¸ºè¾“å‡ºå·®åˆ†(ä»å·¦åˆ°å³ï¼Œä»0åˆ°f)ï¼Œæ±‚å·®åˆ†åˆ†å¸ƒè¡¨çš„ä»£ç æ”¾åœ¨åé¢çš„expä¸­<br >
ç®€å•çœ‹ä¸€ä¸‹ä¼šå‘ç°é™¤äº†å·¦ä¸Šè§’å›ºå®šçš„16ï¼Œç¬¬12è¡Œå’Œç¬¬16è¡Œæœ‰ä¸¤ä¸ª8ï¼Œ8æ„å‘³ç€è¾“å‡ºå·®åˆ†æœ‰1/2çš„æ¦‚ç‡å‡ºç°ï¼Œæ¯”å…¶ä»–æƒ…å†µæ¦‚ç‡å¾ˆå¤§ï¼Œå…·ä½“åœ°ï¼Œè¾“å…¥å·®åˆ†ä¸ºfæ—¶ï¼Œè¾“å‡ºå·®åˆ†ä¸º3çš„æ¦‚ç‡ä¸º1/2ï¼›è¾“å…¥å·®åˆ†ä¸ºbæ—¶ï¼Œè¾“å‡ºå·®åˆ†ä¸ºcçš„æ¦‚ç‡ä¸º1/2ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ä¸»è¦åˆ©ç”¨çš„åœ°æ–¹<br ></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
</span></span><span class="line"><span class="cl">[0, 0, 0, 4, 0, 2, 4, 2, 0, 2, 0, 2, 0, 0, 0, 0]
</span></span><span class="line"><span class="cl">[0, 6, 0, 4, 2, 0, 0, 0, 0, 0, 0, 2, 0, 0, 2, 0]
</span></span><span class="line"><span class="cl">[0, 0, 2, 0, 2, 0, 2, 2, 4, 0, 2, 0, 0, 2, 0, 0]
</span></span><span class="line"><span class="cl">[0, 2, 2, 0, 0, 4, 0, 0, 0, 0, 0, 0, 2, 0, 0, 6]
</span></span><span class="line"><span class="cl">[0, 0, 2, 0, 2, 0, 4, 0, 0, 4, 2, 0, 2, 0, 0, 0]
</span></span><span class="line"><span class="cl">[0, 2, 2, 0, 2, 0, 2, 0, 0, 0, 0, 0, 0, 0, 6, 2]
</span></span><span class="line"><span class="cl">[0, 2, 0, 0, 0, 2, 0, 4, 4, 2, 0, 0, 0, 2, 0, 0]
</span></span><span class="line"><span class="cl">[0, 0, 0, 0, 4, 0, 0, 0, 2, 0, 2, 4, 2, 0, 2, 0]
</span></span><span class="line"><span class="cl">[0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 2, 2, 6, 0, 2]
</span></span><span class="line"><span class="cl">[0, 0, 0, 0, 0, 2, 0, 2, 0, 2, 4, 2, 0, 0, 0, 4]
</span></span><span class="line"><span class="cl">[0, 2, 0, 0, 0, 0, 2, 0, 2, 0, 0, 0, 8, 0, 0, 2]
</span></span><span class="line"><span class="cl">[0, 2, 0, 0, 2, 2, 0, 2, 0, 2, 0, 4, 0, 0, 2, 0]
</span></span><span class="line"><span class="cl">[0, 0, 6, 0, 0, 0, 0, 2, 2, 0, 0, 0, 0, 2, 4, 0]
</span></span><span class="line"><span class="cl">[0, 0, 0, 0, 2, 4, 2, 0, 2, 0, 6, 0, 0, 0, 0, 0]
</span></span><span class="line"><span class="cl">[0, 0, 0, 8, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0]
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç ´è§£æ€è·¯å°±æ˜¯æ„é€ ä¸¤ç»„æ•°æ®ï¼Œä¸€ç»„æ˜¯è¾“å…¥å·®åˆ†ä¸ºf(0x0000 0x000f)ï¼Œå¦ä¸€ç»„æ˜¯è¾“å…¥å·®åˆ†ä¸ºb(0x0000 0x000b)ï¼Œè¿™é‡Œä»¥m1=0x0000, m2=0x000fä¸ºä¾‹ç®€è¿°ï¼ŒæŸ¥è¯¢å¾—åˆ°å¯¹åº”çš„å¯†æ–‡c1ï¼Œc2ï¼Œç„¶åæšä¸¾k2ï¼Œå¾—åˆ°w1ï¼Œw2(c2å¼‚æˆ–k2)ï¼Œè®¡ç®—w1å’Œw2é€šè¿‡Sç›’çš„é€†åçš„v1å’Œv2ï¼Œè®¡ç®—v1 xor v2 å³v1å’Œv2çš„å·®åˆ†ï¼Œåˆ™u1=v1 xor k1ï¼Œu2=v2 xor k1ï¼Œv1å’Œv2çš„å·®åˆ†ä¸u1å’Œu2çš„å·®åˆ†ç›¸ç­‰ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†u1å’Œu2çš„å·®åˆ†ï¼Œç”±ä¸ŠçŸ¥ï¼Œè¾“å…¥å·®åˆ†ä¸ºfæ—¶ï¼Œè¾“å‡ºå·®åˆ†ææœ‰å¯èƒ½æ˜¯3ï¼Œæˆ‘ä»¬å–å‡ºæ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„k2ï¼Œç„¶åç±»ä¼¼åœ°ï¼Œæ±‚å‡ºè¿™äº›k2ä¸­æ»¡è¶³è¾“å…¥å·®åˆ†ä¸ºbæƒ…å†µçš„è§£ï¼Œç›¸å½“äºè¿›ä¸€æ­¥å‡å°èŒƒå›´ï¼Œå°½ç®¡åšäº†ä¸¤è½®ï¼Œè¾“å‡ºçš„k2é›†åˆä»ä¸èƒ½å”¯ä¸€ç¡®å®šï¼Œå¯èƒ½æ˜¯0ï¼Œ16ï¼Œ32&hellip;(è¯•å‡ºæ¥çš„ç»“æœ)ï¼Œè‹¥k2é›†åˆä¸ä¸ºç©ºï¼Œæˆ‘ä»¬å°±æäº¤é›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåå¤å°è¯•ï¼Œå¯ä»¥æˆåŠŸ
<img src="/p/newstar-ctf-2025-crypto-wp/img1.png"
	width="990"
	height="210"
	srcset="/p/newstar-ctf-2025-crypto-wp/img1_hu_d171d002de9b2940.png 480w, /p/newstar-ctf-2025-crypto-wp/img1_hu_fbdb063d46ab2be3.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="471"
		data-flex-basis="1131px"
	
>
expï¼Œè·‘ä¸€æ¬¡expç›¸å½“äºäº¤äº’100æ¬¡ï¼Œæˆ‘æµ‹è¯•çš„ç»“æœæ˜¯å¤§æ¦‚è¿è¡Œä¸¤æ¬¡è„šæœ¬ï¼Œå°±æœ‰å…¶ä¸­ä¸€æ¬¡èƒ½æ‹¿åˆ°flagï¼Œ<del>å…·ä½“æ¦‚ç‡æˆ‘ä¹Ÿä¸çŸ¥é“</del>ï¼Œä¸è¿‡ç¡®å®å¯è¡Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">deblock</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[(</span><span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">,</span> <span class="n">m</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">block</span><span class="p">(</span><span class="n">nibbles</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">nibbles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">nibbles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">nibbles</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">nibbles</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ±‚å·®åˆ†åˆ†å¸ƒè¡¨</span>
</span></span><span class="line"><span class="cl">    <span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">        <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">^</span> <span class="n">j</span>
</span></span><span class="line"><span class="cl">            <span class="n">output</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">table</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">output</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">S_inv</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">S_inv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;39.106.48.123&#39;</span><span class="p">,</span> <span class="mi">37344</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Your input: &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Your input: &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp1</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">c1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="n">tmp1</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Your input: &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp1</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">c2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="n">tmp1</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Your input: &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp1</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">c3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="n">tmp1</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">k2_list1</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0xffff</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">w1</span> <span class="o">=</span> <span class="n">deblock</span><span class="p">(</span><span class="n">c1</span> <span class="o">^</span> <span class="n">k2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">w2</span> <span class="o">=</span> <span class="n">deblock</span><span class="p">(</span><span class="n">c2</span> <span class="o">^</span> <span class="n">k2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">v1</span> <span class="o">=</span> <span class="p">[</span><span class="n">S_inv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">w1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">v2</span> <span class="o">=</span> <span class="p">[</span><span class="n">S_inv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">w2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">v1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">v2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">k2_list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">k2_list2</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="n">k2_list1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">w1</span> <span class="o">=</span> <span class="n">deblock</span><span class="p">(</span><span class="n">c1</span> <span class="o">^</span> <span class="n">k2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">w3</span> <span class="o">=</span> <span class="n">deblock</span><span class="p">(</span><span class="n">c3</span> <span class="o">^</span> <span class="n">k2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">v1</span> <span class="o">=</span> <span class="p">[</span><span class="n">S_inv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">w1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">v3</span> <span class="o">=</span> <span class="p">[</span><span class="n">S_inv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">w3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">v1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">v3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">k2_list2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">k2_list2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k2_list2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">key</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">k2_list2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Your key:&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="sa">b</span><span class="s1">&#39;You can smile&#39;</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="s1">&#39;__name__&#39;</span> <span class="o">==</span> <span class="s1">&#39;__name__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{Ur_awesome_4_being_able_2_successfully_find_1_high-probability_delta(?)_path!}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä¸ç»™ä½ çœ‹å–µ">ä¸ç»™ä½ çœ‹å–µ
</h3><p>é¢˜ç›®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">FLAG</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="mi">225791639467198034995070527100776477487</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span><span class="o">=</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">h</span><span class="o">=</span><span class="mi">5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">C</span><span class="o">=</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">bit</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;Every bit: &#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bit</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">S</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;&gt;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">R</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;&gt;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">R</span><span class="o">&gt;</span><span class="n">S</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">S</span><span class="o">==</span><span class="nb">sum</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">%</span><span class="n">p</span><span class="o">==</span><span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="o">%</span><span class="n">p</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">round</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">FLAG</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ»¡è¶³assertçš„å››ä¸ªæ¡ä»¶ï¼ŒR&gt;Så¾ˆç›´ç™½ï¼Œ<code>S==sum(s[i]*x[i] for i in range(n))</code>ç”±äºnæ˜¯16ï¼Œå¯æšä¸¾ï¼Œæˆ‘ä»¬ç›´æ¥ç”±aå’Œtçˆ†ç ´å‡ºxï¼Œé‚£ä¹ˆSå°±èƒ½ç›´æ¥æ±‚å‡ºæ¥äº†<br >
ä¸‹ä¸€ä¸ªè¦æ±‚æ˜¯Cæ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½è¦å¤§äº1ï¼ŒCæ˜¯æˆ‘ä»¬è‡ªå·±å¯æ§çš„(æ³¨æ„Cå’Œxæ²¡å…³ç³»)ï¼Œæ„é€ çš„Cè¦æ»¡è¶³ç¬¬å››ä¸ªæ¡ä»¶ï¼Œä¹Ÿæ˜¯è¿™é“é¢˜ç›®çš„æ ¸å¿ƒ</p>
$$
\prod_{i=0}^{15} (C_i^{s_i} \mod p) \equiv \left( g^S \cdot h^R \right) \mod p
$$<p>æœ´ç´ çš„æƒ³æ³•æ˜¯ï¼Œç»™cå–ä¸ªæ¯”è¾ƒå°çš„æ•°ï¼Œæ¯”å¦‚éƒ½æ˜¯2ï¼Œç„¶åæ•´ä¸ªå¼å­é‡Œåªæœ‰Ræ˜¯æœªçŸ¥çš„äº†ï¼Œæ±‚ä¸ªç¦»æ•£å¯¹æ•°å°±ç»“æŸäº†ï¼Œä¸è¿‡ä¸å¯è¡Œï¼Œå› ä¸ºæ•°å¤ªå¤§ï¼Œç¦»æ•£å¯¹æ•°è€—æ—¶å¤ªé•¿<br >
è¿™é‡Œç»™å‡ºæˆ‘çš„æ„é€ ï¼Œç”±äº<code>S==sum(s[i]*x[i] for i in range(n))</code>ï¼Œgçš„Sæ¬¡å¹‚å¯ä»¥å±•å¼€å¦‚ä¸‹
</p>
$$
g^{\sum_{i=0}^{15} s_i x_i} = g^{s_0 x_0} \cdot g^{s_1 x_1} \cdots g^{s_{15} x_{15}}
$$<p>
åˆ©ç”¨ä¸¤è¾¹çš„æŒ‡æ•°ä¸Šéƒ½æœ‰siçš„ç‰¹ç‚¹ï¼Œä¸”xiåªèƒ½å–0å’Œ1ï¼Œè‹¥xiå–0ï¼Œæˆ‘ä»¬å°±ç»™Ciå–p-1ï¼Œè¿™æ ·Ciçš„siæ¬¡å¹‚åªèƒ½æ˜¯æ­£è´Ÿ1ï¼Œå–å†³äºsiçš„å¥‡å¶æ€§ï¼Œè‹¥xiå–1ï¼Œæˆ‘ä»¬å°±ç»™Ciå–gï¼Œè¿™æ ·ä¸‹æ¥ï¼Œgçš„Sæ¬¡å¹‚å’Œç­‰å·å·¦è¾¹è¦ä¹ˆç›¸ç­‰ï¼Œè¦ä¹ˆå·®ä¸ªè´Ÿå·ï¼Œä¸‹é¢æˆ‘ä»¬è®©hçš„Ræ¬¡å¹‚ä¸º1ï¼Œåˆ©ç”¨è´¹é©¬å°å®šç†ï¼ŒR=k*(p-1)ï¼Œä¹˜ä¸€ä¸ªkæ˜¯ä¸ºäº†æ»¡è¶³R&gt;S<br >
ä¾æ—§æ˜¯æ¦‚ç‡æ€§åšæ³•ï¼Œæˆ‘ä»¬å¤šè¯•å‡ æ¬¡ï¼Œåªè¦gçš„Sæ¬¡å¹‚å’Œç­‰å·å·¦è¾¹ç›¸ç­‰ï¼Œå°±èƒ½æ‹¿åˆ°flagäº†(ä¸éœ€è¦å¾ˆå¤šæ¬¡å°±èƒ½å‡º)<br ></p>
<p>expï¼Œæ²¡æœ‰ç”¨pwntoolsï¼Œéœ€è¦æ‰‹åŠ¨å¤åˆ¶ç²˜è´´æ•°æ®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">t</span> <span class="o">=</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">i1</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i1</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i1</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">tmp</span> <span class="o">==</span> <span class="n">t</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="mi">225791639467198034995070527100776477487</span>
</span></span><span class="line"><span class="cl"><span class="n">g</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">h</span> <span class="o">=</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">i1</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">C</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">S</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æµ‹è¯•ï¼Œè‹¥ç›¸ç­‰ï¼Œå°±å»ç®—ä¸€ä¸ªRï¼Œå°±æˆåŠŸäº†</span>
</span></span><span class="line"><span class="cl"><span class="n">tmp</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="n">tmp1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">tmp</span> <span class="o">==</span> <span class="n">tmp1</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># flag{Do_u_r3a1ly_n33d_me_2_5h0w_u_2_pr0v3_7h4t_1_h4v3_it?}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="blså¤šé‡ç­¾åé›¶çš„è£‚å˜">BLSå¤šé‡ç­¾åï¼šé›¶çš„è£‚å˜
</h3><p>é¢˜ç›®å¤ªé•¿äº†å°±ä¸è´´äº†ï¼Œæœ‰ç‚¹ç±»ä¼¼ä¸Šå‘¨çš„å…±è½­è¿·å®«ï¼Œå¦‚æœä¸çŸ¥é“è¿™ä¸ªé¢˜è€ƒçš„çŸ¥è¯†ç‚¹çš„è¯å°±ç¡®å®ä¸å¥½åš<br >
ç®€å•è¯´å°±æ˜¯æœåŠ¡å™¨ç«¯æœ‰ä¸€ä¸ªå…¬é’¥ï¼Œæˆ‘ä»¬è‡ªå·±æ³¨å†Œä¸¤ä¸ªå…¬é’¥ï¼Œä¸‰ä¸ªå…¬é’¥ç»„æˆçš„èšåˆå…¬é’¥å¿…é¡»ç­‰äºæœåŠ¡å™¨çš„å›ºå®šå…¬é’¥ï¼Œä¸”èšåˆç­¾åéªŒè¯é€šè¿‡<br >
åœ¨BLSç­¾åä¸­ï¼Œèšåˆå…¬é’¥æ˜¯é€šè¿‡å°†å¤šä¸ªå…¬é’¥ï¼ˆæ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ï¼‰ç›¸åŠ å¾—åˆ°çš„ï¼Œå…·ä½“åœ°<br >
ç§é’¥æ˜¯ä¸€ä¸ªå¤§æ•´æ•° sk <br >
å…¬é’¥æ˜¯æ¤­åœ†æ›²çº¿ä¸Šçš„ä¸€ä¸ªç‚¹ï¼šPK = sk Ã— G<br >
è‹¥æˆ‘ä»¬æ„é€ sk2=-sk1ï¼Œåˆ™èšåˆå…¬é’¥å°±æ˜¯æœåŠ¡å™¨çš„å›ºå®šå…¬é’¥ï¼Œé‚£ä¹ˆèšåˆå…¬é’¥çš„ç­¾åè‡ªç„¶å°±å’ŒæœåŠ¡å™¨çš„å›ºå®šå…¬é’¥çš„ä¸€æ ·äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡&rsquo;sign&rsquo;å‘½ä»¤æ‹¿åˆ°ç­¾åï¼Œç„¶åç›´æ¥åˆ©ç”¨å³å¯<br ></p>
<p>exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">socket</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">py_ecc.bls</span> <span class="kn">import</span> <span class="n">G2ProofOfPossession</span> <span class="k">as</span> <span class="n">bls</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">order</span> <span class="o">=</span> <span class="mi">52435875175126190479447740508185965837690552500527637822603658699938581184513</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s1">&#39;39.106.48.123&#39;</span><span class="p">,</span> <span class="mi">26282</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;get_info&#34;</span><span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">server_info</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">server_pk</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">server_info</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;server_pk&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">sk1</span> <span class="o">=</span> <span class="mi">111</span>
</span></span><span class="line"><span class="cl">    <span class="n">pk1</span> <span class="o">=</span> <span class="n">bls</span><span class="o">.</span><span class="n">SkToPk</span><span class="p">(</span><span class="n">sk1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sk2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">sk1</span><span class="p">)</span> <span class="o">%</span> <span class="n">order</span>
</span></span><span class="line"><span class="cl">    <span class="n">pk2</span> <span class="o">=</span> <span class="n">bls</span><span class="o">.</span><span class="n">SkToPk</span><span class="p">(</span><span class="n">sk2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ³¨å†Œå…¬é’¥è¦éªŒè¯pop</span>
</span></span><span class="line"><span class="cl">    <span class="n">pop1</span> <span class="o">=</span> <span class="n">bls</span><span class="o">.</span><span class="n">Sign</span><span class="p">(</span><span class="n">sk1</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;POP&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pop2</span> <span class="o">=</span> <span class="n">bls</span><span class="o">.</span><span class="n">Sign</span><span class="p">(</span><span class="n">sk2</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;POP&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="n">pk</span><span class="p">,</span> <span class="n">pop</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;register&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;pk&#34;</span><span class="p">:</span> <span class="n">pk</span><span class="o">.</span><span class="n">hex</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;pop&#34;</span><span class="p">:</span> <span class="n">pop</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">response</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">register</span><span class="p">(</span><span class="n">pk1</span><span class="p">,</span> <span class="n">pop1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">register</span><span class="p">(</span><span class="n">pk2</span><span class="p">,</span> <span class="n">pop2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;sign&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;msg&#34;</span><span class="p">:</span> <span class="s2">&#34;get_flag&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sig_response</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">server_sig</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">sig_response</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">pks_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">pk1</span><span class="o">.</span><span class="n">hex</span><span class="p">(),</span> <span class="n">pk2</span><span class="o">.</span><span class="n">hex</span><span class="p">(),</span> <span class="n">server_pk</span><span class="o">.</span><span class="n">hex</span><span class="p">()]</span>
</span></span><span class="line"><span class="cl">    <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;get_flag&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;pks&#34;</span><span class="p">:</span> <span class="n">pks_list</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;sig&#34;</span><span class="p">:</span> <span class="n">server_sig</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag_response</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;FLAG:&#34;</span><span class="p">,</span> <span class="n">flag_response</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># flag{a53b79c7-629d-404a-89fa-4d0d8ee06b6f}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>é¢˜å¤–è¯ï¼Œç”±äºè¦è£…py_eccï¼Œæˆ‘ç”¨çš„wslç›´æ¥è£…ä¸äº†ï¼Œè¦ç”¨è™šæ‹Ÿç¯å¢ƒï¼Œè®°å½•ä¸€ä¸‹<br >
sudo apt install python3-venv<br >
python3 -m venv bls_env # åˆ›å»º<br >
source bls_env/bin/activate # æ¿€æ´»<br >
pip install py-ecc</p>
</blockquote>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/crypto/">Crypto</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        const elementsToRender = [".main-article", ".widget--toc"];

        elementsToRender.forEach(selector => {
            const element = document.querySelector(selector);
            if (element) {
                renderMathInElement(element, {
                    delimiters: [
                        { left: "$$", right: "$$", display: true },
                        { left: "$", right: "$", display: false },
                        { left: "\\(", right: "\\)", display: false },
                        { left: "\\[", right: "\\]", display: true }
                    ],
                    ignoredClasses: ["gist"]
                });
            }
        });
    });
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/moectf-2025-crypto-wp/">
        
        
            <div class="article-image">
                <img src="/p/moectf-2025-crypto-wp/fengmian.e9d18e3da72d2ac7b144251df18a2f11.e9d18e3da72d2ac7b144251df18a2f11_hu_e0b032d28d087b41.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post MoeCTF 2025 Crypto WP"
                        
                        data-hash="md5-6dGOPactKsexRCUd8YovEQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">MoeCTF 2025 Crypto WP</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 hata
    </section>
    
    <section class="powerby">
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.32.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.884460734613d5e85247b63e1915405c54071b98eccd53eda431ec100faee589.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
